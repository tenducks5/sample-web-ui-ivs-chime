{"version":3,"sources":["config.js","components/chime/ChimeSdkWrapper.js","components/chimeWeb/Error.jsx","components/chimeWeb/Welcome.jsx","components/chimeWeb/Join.jsx","components/videoPlayer/VideoPlayer.jsx","components/chat/Chat.jsx","components/chimeWeb/Controls.jsx","components/chimeWeb/Settings.jsx","components/chimeWeb/LocalVideo.jsx","components/chimeWeb/RemoteVideo.jsx","components/chimeWeb/RemoteVideoGroup.jsx","components/chimeWeb/Meeting.jsx","components/chimeWeb/End.jsx","components/App.js","serviceWorker.js","index.js"],"names":["DEBUG","ChimeSdkWrapper","this","initializeSdkWrapper","meetingSession","audioVideo","title","name","region","currentAudioInputDevice","currentAudioOutputDevice","currentVideoInputDevice","audioInputDevices","audioOutputDevices","videoInputDevices","devicesUpdatedCallbacks","roster","rosterUpdateCallbacks","configuration","messagingSocket","messageUpdateCallbacks","error","console","role","playbackURL","a","payload","fetch","method","body","JSON","stringify","response","json","Error","JoinInfo","MeetingSessionConfiguration","Meeting","Attendee","initializeMeetingSession","Title","logger","ConsoleLogger","LogLevel","ERROR","deviceController","DefaultDeviceController","DefaultMeetingSession","listAudioInputDevices","forEach","mediaDeviceInfo","push","label","value","deviceId","listAudioOutputDevices","listVideoInputDevices","publishDevicesUpdated","addDeviceChangeObserver","realtimeSubscribeToAttendeeIdPresence","presentAttendeeId","present","publishRosterUpdate","realtimeSubscribeToVolumeIndicator","attendeeId","volume","muted","signalStrength","DefaultModality","base","Math","round","encodeURIComponent","AttendeeInfo","Name","element","logError","window","addEventListener","event","reason","audioInputs","length","chooseAudioInputDevice","audioOutputs","chooseAudioOutputDevice","videoInputs","chooseVideoInputDevice","bindAudioElement","start","messagingUrl","meetingId","credentials","joinToken","ReconnectingPromisedWebSocket","DefaultPromisedWebSocketFactory","DefaultDOMWebSocketFactory","FullJitterBackoff","open","WEB_SOCKET_TIMEOUT_MS","data","parse","publishMessageUpdate","type","timestampMs","Date","now","message","send","end","stop","device","freshAudioInputDeviceList","hasCurrentDevice","freshAudioOutputDeviceList","freshVideoInputDeviceList","callback","index","indexOf","splice","throttle","i","ROSTER_THROTTLE_MS","handleKeyDown","e","keyCode","props","closeError","handleClick","node","target","isModal","classList","contains","parentNode","handleGoCreateRoom","location","replace","document","removeEventListener","className","onClick","viewBox","xmlns","d","errorMsg","Component","Welcome","state","username","showError","handleNameChange","setState","handleRoomChange","handlePlaybackURLChange","handleCreateRoom","preventDefault","stopPropagation","createRoom","setErrorMsg","baseHref","inputRef","React","createRef","qs","URLSearchParams","search","get","history","current","focus","sessionStorage","setItem","createRoomDisabled","Fragment","action","placeholder","ref","onChange","disabled","withRouter","Join","joinRoom","handleJoinRoom","room","joinRoomDisabled","VideoPlayer","mediaPlayerScriptLoaded","MediaPlayerPackage","IVSPlayer","playerOverlay","getElementById","btnPlay","btnMute","isPlayerSupported","PlayerState","PlayerEventType","player","create","attachHTMLVideoElement","PLAYING","config","ENDED","READY","err","TEXT_METADATA_CUE","cue","text","getPosition","toFixed","setAutoplay","load","videoStream","setVolume","add","remove","pause","play","setMuted","warn","videoElement","maxMetaData","metaData","mediaPlayerScript","createElement","src","async","onload","appendChild","id","height","width","playsInline","Chat","scrollToBottom","messagesEndRef","scrollIntoView","behavior","handleChange","connection","handleRoomClick","link","origin","pathname","copyTextToClipboard","encodeURI","setShowPopup","showPopup","setTimeout","navigator","clipboard","writeText","then","parseUrls","userInput","match","formattedMatch","startsWith","renderMessages","messages","map","formattedMessage","dangerouslySetInnerHTML","__html","timestamp","chatRef","initChatConnection","joinInfo","MeetingId","AttendeeId","JoinToken","split","slice","join","popup","fill","maxLength","onKeyDown","Controls","videoStatus","localMuted","muteButtonOnClick","chime","realtimeUnmuteLocalAudio","realtimeMuteLocalAudio","Promise","resolve","videoButtonOnClick","startLocalVideoTile","stopLocalVideoTile","endButtonOnClick","leaveRoom","removeItem","ssName","whereTo","realtimeSubscribeToMuteAndUnmuteLocalAudio","realtimeUnsubscribeToMuteAndUnmuteLocalAudio","mic_controls","cam_controls","openSettings","Settings","microphone","speaker","camera","devicesUpdatedCallback","fullDeviceInfo","closeSettings","handleMicrophoneChange","selectedDevice","o","handleSpeakerChange","handleCameraChange","handleSave","saveSettings","renderDevices","devices","defaultValue","subscribeToDevicesUpdated","unsubscribeFromDevicesUpdated","currentMic","currentSpeaker","currentCam","availableMics","availableSpeakers","availableCams","readOnly","PlaybackURL","LocalVideo","enabled","showMeta","rosterCallback","newRoster","addObserver","videoTileDidUpdate","tileState","boundAttendeeId","localTile","tileId","bindVideoElement","active","subscribeToRosterUpdate","unsubscribeFromRosterUpdate","micMuteCls","metaCls","onMouseEnter","handleMouseEnter","bind","onMouseLeave","handleMouseLeave","data-id","RemoteVideo","videoEnabled","camClass","videoId","RemoteVideoGroup","rosterChanged","findRosterSlot","Object","keys","previousRoster","differ","filter","k","assign","attendee","videoTileDidUpdateCallback","isContent","videoTileWasRemovedCallback","find","Array","from","key","videoTileWasRemoved","meetingStatus","showSettings","setMetadataId","metadataId","layout","myVideoElement","audioElementRef","getItem","ssData","reInitializeMeetingSession","audioVideoDidStop","sessionStatus","statusCode","MeetingSessionStatusCode","AudioCallEnded","style","display","End","href","App","path","Boolean","hostname","ReactDOM","render","StrictMode","serviceWorker","ready","registration","unregister","catch"],"mappings":"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","file":"static/js/main.62d8d3c9.chunk.js","sourcesContent":["export const BASE_HREF = \"\";\n\n// API endpoint for retrieving the attendees list, joining the room, and ending the room\nexport const CHIME_ROOM_API = \"\";\n\n// Chime-SDK allows up to 16 attendee videos\nexport const CHIME_ROOM_MAX_ATTENDEE = 16;\n\n// Default video stream to play inside the video player\nexport const DEFAULT_VIDEO_STREAM = \"https://fcc3ddae59ed.us-west-2.playback.live-video.net/api/video/v1/us-west-2.893648527354.channel.DmumNckWFTqz.m3u8\";\n\n// Default Chat websocket link\nexport const CHAT_WEBSOCKET = \"\";\n\n// Chime-SDK logging level: INFO, WARN, ERROR, DEBUG\nexport const CHIME_LOG_LEVEL = 'WARN';\n\n// Chime-Web UI debugging logging: true / false\nexport const DEBUG = false;\n","import {\n  ConsoleLogger,\n  DefaultDeviceController,\n  DefaultDOMWebSocketFactory,\n  DefaultMeetingSession,\n  DefaultModality,\n  DefaultPromisedWebSocketFactory,\n  FullJitterBackoff,\n  LogLevel,\n  MeetingSessionConfiguration,\n  ReconnectingPromisedWebSocket\n} from 'amazon-chime-sdk-js';\n\nimport throttle from 'lodash/throttle';\nimport * as config from '../../config';\n\n\nexport default class ChimeSdkWrapper {\n\n  static WEB_SOCKET_TIMEOUT_MS = 10000;\n  static ROSTER_THROTTLE_MS = 400;\n\n  constructor() {\n    this.initializeSdkWrapper();\n  }\n\n  initializeSdkWrapper() {\n    this.meetingSession = null;\n    this.audioVideo = null;\n    this.title = null;\n    this.name = null;\n    this.region = null;\n    this.currentAudioInputDevice = null;\n    this.currentAudioOutputDevice = null;\n    this.currentVideoInputDevice = null;\n    this.audioInputDevices = [];\n    this.audioOutputDevices = [];\n    this.videoInputDevices = [];\n    this.devicesUpdatedCallbacks = [];\n    this.roster = {};\n    this.rosterUpdateCallbacks = [];\n    this.configuration = null;\n    this.messagingSocket = null;\n    this.messageUpdateCallbacks = [];\n  }\n\n  logError(error) {\n    console.error(error);\n  }\n\n  async createRoom(role, name, title, playbackURL, region) {\n    if (!name || !title || !role) {\n      console.error(\n           `role=${role} name=${name} title=${title} must exist`\n      );\n      return;\n    }\n\n    const payload = {\n      name,\n      title,\n      playbackURL,\n      role\n    };\n\n    const response = await fetch(\n      `${config.CHIME_ROOM_API}/join`,\n      {\n        method: 'POST',\n        body: JSON.stringify(payload)\n      }\n    );\n    const json = await response.json();\n    if (json.error) {\n      throw new Error(\n        json.error\n      );\n    }\n\n    const { JoinInfo } = json;\n    if (!JoinInfo) {\n      throw new Error(\n        'CreateOrJoin.classRoomDoesNotExist'\n      );\n    }\n    this.configuration = new MeetingSessionConfiguration(\n      JoinInfo.Meeting,\n      JoinInfo.Attendee\n    );\n    await this.initializeMeetingSession(this.configuration);\n\n    this.title = title;\n    this.name = name;\n    this.region = region;\n\n    return JoinInfo;\n  }\n\n  async reInitializeMeetingSession(JoinInfo, name) {\n    this.configuration = new MeetingSessionConfiguration(\n      JoinInfo.Meeting,\n      JoinInfo.Attendee\n    );\n    await this.initializeMeetingSession(this.configuration);\n\n    this.title = JoinInfo.Title;\n    this.name = name;\n    // this.region = region;\n  }\n\n  async initializeMeetingSession(configuration) {\n    const logger = new ConsoleLogger('SDK', LogLevel.ERROR);\n    const deviceController = new DefaultDeviceController(logger);\n    this.meetingSession = new DefaultMeetingSession(\n      configuration,\n      logger,\n      deviceController\n    );\n    this.audioVideo = this.meetingSession.audioVideo;\n\n    this.audioInputDevices = [];\n    (await this.audioVideo.listAudioInputDevices()).forEach(\n      (mediaDeviceInfo) => {\n        this.audioInputDevices.push({\n          label: mediaDeviceInfo.label,\n          value: mediaDeviceInfo.deviceId\n        });\n      }\n    );\n    this.audioOutputDevices = [];\n    (await this.audioVideo.listAudioOutputDevices()).forEach(\n      (mediaDeviceInfo) => {\n        this.audioOutputDevices.push({\n          label: mediaDeviceInfo.label,\n          value: mediaDeviceInfo.deviceId\n        });\n      }\n    );\n    this.videoInputDevices = [];\n    (await this.audioVideo.listVideoInputDevices()).forEach(\n      (mediaDeviceInfo) => {\n        this.videoInputDevices.push({\n          label: mediaDeviceInfo.label,\n          value: mediaDeviceInfo.deviceId\n        });\n      }\n    );\n    this.publishDevicesUpdated();\n    this.audioVideo.addDeviceChangeObserver(this);\n\n    this.audioVideo.realtimeSubscribeToAttendeeIdPresence(\n      (presentAttendeeId, present) => {\n        if (!present) {\n          delete this.roster[presentAttendeeId];\n          //this.publishRosterUpdate.cancel();\n          this.publishRosterUpdate()();\n          return;\n        }\n\n        this.audioVideo.realtimeSubscribeToVolumeIndicator(\n          presentAttendeeId,\n          async (\n            attendeeId,\n            volume,\n            muted,\n            signalStrength\n          ) => {\n            const baseAttendeeId = new DefaultModality(attendeeId).base();\n            if (baseAttendeeId !== attendeeId) {\n              // Don't include the content attendee in the roster.\n              //\n              // When you or other attendees share content (a screen capture, a video file,\n              // or any other MediaStream object), the content attendee (attendee-id#content) joins the session and\n              // shares content as if a regular attendee shares a video.\n              //\n              // For example, your attendee ID is \"my-id\". When you call meetingSession.audioVideo.startContentShare,\n              // the content attendee \"my-id#content\" will join the session and share your content.\n              return;\n            }\n\n            let shouldPublishImmediately = false;\n\n            if (!this.roster[attendeeId]) {\n              this.roster[attendeeId] = { name: '' };\n            }\n            if (volume !== null) {\n              this.roster[attendeeId].volume = Math.round(volume * 100);\n            }\n            if (muted !== null) {\n              this.roster[attendeeId].muted = muted;\n            }\n            if (signalStrength !== null) {\n              this.roster[attendeeId].signalStrength = Math.round(\n                signalStrength * 100\n              );\n            }\n            if (this.title && attendeeId && !this.roster[attendeeId].name) {\n              const response = await fetch(\n                `${config.CHIME_ROOM_API}/attendee?title=${encodeURIComponent(\n                  this.title\n                )}&attendeeId=${encodeURIComponent(attendeeId)}`\n              );\n              const json = await response.json();\n              if (json.AttendeeInfo && this.roster[attendeeId]) {\n                this.roster[attendeeId].name = json.AttendeeInfo.Name || '';\n                shouldPublishImmediately = true;\n              }\n            }\n\n            if (shouldPublishImmediately) {\n              //this.publishRosterUpdate.cancel();\n            }\n            this.publishRosterUpdate()();\n          }\n        );\n      }\n    );\n  }\n\n  async joinRoom(element) {\n    if (!element) {\n      this.logError(new Error(`element does not exist`));\n      return;\n    }\n\n    window.addEventListener(\n      'unhandledrejection',\n      (event) => {\n        this.logError(event.reason);\n      }\n    );\n\n    const audioInputs = await this.audioVideo.listAudioInputDevices();\n    if (audioInputs && audioInputs.length > 0 && audioInputs[0].deviceId) {\n      this.currentAudioInputDevice = {\n        label: audioInputs[0].label,\n        value: audioInputs[0].deviceId\n      };\n      await this.audioVideo.chooseAudioInputDevice(audioInputs[0].deviceId);\n    }\n\n    const audioOutputs = await this.audioVideo.listAudioOutputDevices();\n    if (audioOutputs && audioOutputs.length > 0 && audioOutputs[0].deviceId) {\n      this.currentAudioOutputDevice = {\n        label: audioOutputs[0].label,\n        value: audioOutputs[0].deviceId\n      };\n      await this.audioVideo.chooseAudioOutputDevice(audioOutputs[0].deviceId);\n    }\n\n    const videoInputs = await this.audioVideo.listVideoInputDevices();\n    if (videoInputs && videoInputs.length > 0 && videoInputs[0].deviceId) {\n      this.currentVideoInputDevice = {\n        label: videoInputs[0].label,\n        value: videoInputs[0].deviceId\n      };\n      await this.audioVideo.chooseVideoInputDevice(null);\n    }\n\n    this.publishDevicesUpdated();\n\n    this.audioVideo.bindAudioElement(element);\n    this.audioVideo.start();\n  }\n\n  async joinRoomMessaging() {\n    if (!this.configuration) {\n      this.logError(new Error('configuration does not exist'));\n      return;\n    }\n\n    const messagingUrl = `${config.CHAT_WEBSOCKET}?MeetingId=${this.configuration.meetingId}&AttendeeId=${this.configuration.credentials.attendeeId}&JoinToken=${this.configuration.credentials.joinToken}`;\n    this.messagingSocket = new ReconnectingPromisedWebSocket(\n      messagingUrl,\n      [],\n      'arraybuffer',\n      new DefaultPromisedWebSocketFactory(new DefaultDOMWebSocketFactory()),\n      new FullJitterBackoff(1000, 0, 10000)\n    );\n\n    await this.messagingSocket.open(this.WEB_SOCKET_TIMEOUT_MS);\n\n    this.messagingSocket.addEventListener('message', (event) => {\n      try {\n        const data = JSON.parse(event.data);\n        const { attendeeId } = data.payload;\n\n        let name;\n        if (this.roster[attendeeId]) {\n          name = this.roster[attendeeId].name;\n        }\n\n        this.publishMessageUpdate({\n          type: data.type,\n          payload: data.payload,\n          timestampMs: Date.now(),\n          name\n        });\n      } catch (error) {\n        this.logError(error);\n      }\n    });\n  }\n\n  sendMessage(type, payload) {\n    if (!this.messagingSocket) {\n      return;\n    }\n    const message = {\n      message: 'sendmessage',\n      data: JSON.stringify({ type, payload })\n    };\n    try {\n      this.messagingSocket.send(JSON.stringify(message));\n    } catch (error) {\n      this.logError(error);\n    }\n  }\n\n  async leaveRoom(end) {\n    try {\n      this.audioVideo.stop();\n    } catch (error) {\n      this.logError(error);\n    }\n\n    // try {\n    //   await this.messagingSocket.close(this.WEB_SOCKET_TIMEOUT_MS);\n    // } catch (error) {\n    //   this.logError(error);\n    // }\n\n    try {\n      if (end && this.title) {\n        await fetch(\n          `${config.CHIME_ROOM_API}/end?title=${encodeURIComponent(this.title)}`,\n          {\n            method: 'POST'\n          }\n        );\n      }\n    } catch (error) {\n      this.logError(error);\n    }\n\n    this.initializeSdkWrapper();\n  }\n\n  // Device\n\n  async chooseAudioInputDevice(device) {\n    try {\n      await this.audioVideo.chooseAudioInputDevice(device.value);\n      this.currentAudioInputDevice = device;\n    } catch (error) {\n      this.logError(error);\n    }\n  }\n\n  async chooseAudioOutputDevice(device) {\n    try {\n      await this.audioVideo.chooseAudioOutputDevice(device.value);\n      this.currentAudioOutputDevice = device;\n    } catch (error) {\n      this.logError(error);\n    }\n  }\n\n  async chooseVideoInputDevice(device) {\n    try {\n      await this.audioVideo.chooseVideoInputDevice(device.value);\n      this.currentVideoInputDevice = device;\n    } catch (error) {\n      this.logError(error);\n    }\n  }\n\n  // Observer methods\n\n  audioInputsChanged(freshAudioInputDeviceList) {\n    let hasCurrentDevice = false;\n    this.audioInputDevices = [];\n    freshAudioInputDeviceList.forEach((mediaDeviceInfo) => {\n      if (\n        this.currentAudioInputDevice &&\n        mediaDeviceInfo.deviceId === this.currentAudioInputDevice.value\n      ) {\n        hasCurrentDevice = true;\n      }\n      this.audioInputDevices.push({\n        label: mediaDeviceInfo.label,\n        value: mediaDeviceInfo.deviceId\n      });\n    });\n    if (!hasCurrentDevice) {\n      this.currentAudioInputDevice =\n        this.audioInputDevices.length > 0 ? this.audioInputDevices[0] : null;\n    }\n    this.publishDevicesUpdated();\n  }\n\n  audioOutputsChanged(freshAudioOutputDeviceList) {\n    let hasCurrentDevice = false;\n    this.audioOutputDevices = [];\n    freshAudioOutputDeviceList.forEach((mediaDeviceInfo) => {\n      if (\n        this.currentAudioOutputDevice &&\n        mediaDeviceInfo.deviceId === this.currentAudioOutputDevice.value\n      ) {\n        hasCurrentDevice = true;\n      }\n      this.audioOutputDevices.push({\n        label: mediaDeviceInfo.label,\n        value: mediaDeviceInfo.deviceId\n      });\n    });\n    if (!hasCurrentDevice) {\n      this.currentAudioOutputDevice =\n        this.audioOutputDevices.length > 0 ? this.audioOutputDevices[0] : null;\n    }\n    this.publishDevicesUpdated();\n  }\n\n  videoInputsChanged(freshVideoInputDeviceList) {\n    let hasCurrentDevice = false;\n    this.videoInputDevices = [];\n    freshVideoInputDeviceList.forEach((mediaDeviceInfo) => {\n      if (\n        this.currentVideoInputDevice &&\n        mediaDeviceInfo.deviceId === this.currentVideoInputDevice.value\n      ) {\n        hasCurrentDevice = true;\n      }\n      this.videoInputDevices.push({\n        label: mediaDeviceInfo.label,\n        value: mediaDeviceInfo.deviceId\n      });\n    });\n    if (!hasCurrentDevice) {\n      this.currentVideoInputDevice =\n        this.videoInputDevices.length > 0 ? this.videoInputDevices[0] : null;\n    }\n    this.publishDevicesUpdated();\n  }\n\n  // Subscribe and unsubscribe\n\n  subscribeToDevicesUpdated(callback) {\n    this.devicesUpdatedCallbacks.push(callback);\n  }\n\n  unsubscribeFromDevicesUpdated(callback) {\n    const index = this.devicesUpdatedCallbacks.indexOf(callback);\n    if (index !== -1) {\n      this.devicesUpdatedCallbacks.splice(index, 1);\n    }\n  }\n\n  publishDevicesUpdated() {\n    this.devicesUpdatedCallbacks.forEach(\n      (callback) => {\n        callback({\n          currentAudioInputDevice: this.currentAudioInputDevice,\n          currentAudioOutputDevice: this.currentAudioOutputDevice,\n          currentVideoInputDevice: this.currentVideoInputDevice,\n          audioInputDevices: this.audioInputDevices,\n          audioOutputDevices: this.audioOutputDevices,\n          videoInputDevices: this.videoInputDevices\n        });\n      }\n    );\n  }\n\n  subscribeToRosterUpdate(callback) {\n    this.rosterUpdateCallbacks.push(callback);\n  }\n\n  unsubscribeFromRosterUpdate(callback) {\n    const index = this.rosterUpdateCallbacks.indexOf(callback);\n    if (index !== -1) {\n      this.rosterUpdateCallbacks.splice(index, 1);\n    }\n  }\n\n  publishRosterUpdate() {\n    return throttle(() => {\n      for (let i = 0; i < this.rosterUpdateCallbacks.length; i += 1) {\n        const callback = this.rosterUpdateCallbacks[i];\n        callback(this.roster);\n      }\n    }, this.ROSTER_THROTTLE_MS);\n  }\n\n  subscribeToMessageUpdate(callback) {\n    this.messageUpdateCallbacks.push(callback);\n  }\n\n  unsubscribeFromMessageUpdate(callback) {\n    const index = this.messageUpdateCallbacks.indexOf(callback);\n    if (index !== -1) {\n      this.messageUpdateCallbacks.splice(index, 1);\n    }\n  }\n\n  publishMessageUpdate(message) {\n    for (let i = 0; i < this.messageUpdateCallbacks.length; i += 1) {\n      const callback = this.messageUpdateCallbacks[i];\n      callback(message);\n    }\n  }\n}\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\n// Styles\nimport './Error.css';\n\n// Assets\n\nclass Error extends Component {\n\n  componentDidMount() {\n    document.addEventListener(\"keydown\", this.handleKeyDown);\n\n    // setTimeout(() => {\n    //   this.props.closeError();\n    // }, 10000);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener(\"keydown\", this.handleKeyDown);\n  }\n\n  handleKeyDown = (e) => {\n    if (e.keyCode === 27) { // keyCode 27 is Escape key\n      this.props.closeError();\n    }\n  }\n\n  handleClick = (e) => {\n    let node = e.target;\n    let isModal = false;\n    while (node) {\n      if (node && node.classList && node.classList.contains('notice--error')) {\n        isModal = true;\n        break;\n      }\n      node = node.parentNode;\n    }\n    if (!isModal) {\n      this.props.closeError();\n    }\n  }\n\n  handleGoCreateRoom = () => {\n    window.location.replace(\"/index.html\");\n  }\n\n  render() {\n    return (\n      <div className=\"notice notice--error\" onClick={this.handleClick}>\n        <div className=\"notice__content\">\n          <div className=\"icon icon--24 notice__icon\"><svg viewBox=\"0 0 1000 1000\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M 500 0C 224 0 0 224 0 500C 0 776 224 1000 500 1000C 776 1000 1000 776 1000 500C 1000 224 776 0 500 0C 500 0 500 0 500 0M 526 150C 576 150 602 175 601 224C 600 300 600 350 575 525C 570 560 560 575 525 575C 525 575 475 575 475 575C 440 575 430 560 425 525C 400 355 400 300 400 226C 400 175 425 150 475 150M 500 650C 527 650 552 661 571 679C 589 698 600 723 600 750C 600 805 555 850 500 850C 445 850 400 805 400 750C 400 723 411 698 429 679C 448 661 473 650 500 650C 500 650 500 650 500 650\"/></svg></div>\n          {this.props.errorMsg}\n          <div>To create your own room, click <span className=\"go-create-room\" onClick={this.handleGoCreateRoom}>here</span>.</div>\n        </div>\n      </div>\n    )\n  }\n}\n\nError.propTypes = {\n  errorMsg: PropTypes.string,\n  closeError: PropTypes.func\n};\n\nexport default Error;\n","import React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport * as config from '../../config';\nimport Error from './Error';\n\nclass Welcome extends Component {\n\n  state = {\n    role: 'host',\n    username: '',\n    title: '',\n    playbackURL: config.DEFAULT_VIDEO_STREAM,\n    errorMsg: '',\n    showError: false\n  }\n\n  constructor() {\n    super ();\n    this.baseHref = config.BASE_HREF;\n    this.inputRef = React.createRef();\n  }\n\n  componentDidMount() {\n    const qs = new URLSearchParams(this.props.location.search);\n    const action = qs.get('action');\n    if (action === 'join') {\n      const title = qs.get('room');\n      this.props.history.push(`${this.baseHref}/join?room=${title}`);\n    }\n    this.inputRef.current.focus();\n  }\n\n  handleNameChange = e => {\n    this.setState({ username: e.target.value })\n  }\n\n  handleRoomChange = e => {\n    this.setState({ title: e.target.value })\n  }\n\n  handlePlaybackURLChange = e => {\n    this.setState({ playbackURL: e.target.value })\n  }\n\n  handleCreateRoom = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.createRoom();\n  }\n\n  setErrorMsg = errorMsg => {\n    this.setState({ errorMsg, showError: true });\n  }\n\n  closeError = () => {\n    this.setState({ showError: false });\n  }\n\n  async createRoom() {\n    const { title, username, playbackURL } = this.state;\n    const data = {\n      username,\n      title,\n      playbackURL,\n      role: this.state.role\n    }\n    sessionStorage.setItem(`chime[${title}]`, JSON.stringify(data));\n    this.props.history.push(`${this.baseHref}/meeting?room=${title}`);\n  }\n\n  render() {\n    const { username, title, playbackURL } = this.state;\n    const createRoomDisabled = !username || !title || !playbackURL;\n    return (\n      <React.Fragment>\n        <div className=\"welcome form-grid\">\n\n          <div className=\"welcome__intro\">\n            <div className=\"intro__inner formatted-text\">\n              <h1>Amazon IVS with ChimeSDK</h1>\n              <h3>Create or join rooms, and watch Amazon IVS streams with anyone.</h3>\n            </div>\n          </div>\n\n          <div className=\"welcome__content pd-4\">\n            <div className=\"content__inner\">\n              <h2 className=\"mg-b-2\">Get started</h2>\n              <form action=\"\">\n                <fieldset className=\"mg-b-2\">\n                  <input className=\"mg-b-2\" type=\"text\" placeholder=\"Your name\" value={username} ref={this.inputRef} onChange={this.handleNameChange} />\n                  <input type=\"text\" placeholder=\"Room name\" value={title} onChange={this.handleRoomChange} />\n                  <input type=\"text\" placeholder=\"Playback URL\" value={playbackURL} onChange={this.handlePlaybackURLChange} />\n                  <button className=\"mg-t-2 btn btn--primary\" disabled={createRoomDisabled} onClick={this.handleCreateRoom} >Create room</button>\n                </fieldset>\n              </form>\n            </div>\n          </div>\n\n        </div>\n        {this.state.showError && (\n          <Error\n            closeError={this.closeError}\n            errorMsg={this.state.errorMsg}\n          />\n        )}\n      </React.Fragment>\n    )\n  }\n}\n\nexport default withRouter(Welcome);\n","import React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport * as config from '../../config';\nimport Error from './Error';\n\nclass Join extends Component {\n\n  state = {\n    role: 'attendee',\n    username: '',\n    title: '',\n    errorMsg: '',\n    showError: false\n  }\n\n  constructor() {\n    super ();\n    this.inputRef = React.createRef();\n    this.baseHref = config.BASE_HREF;\n  }\n\n  componentDidMount() {\n    const qs = new URLSearchParams(this.props.location.search);\n    const room = qs.get('room');\n    this.setState({ title: room });\n  }\n\n  joinRoom = async () => {\n    const { username, title } = this.state;\n    const data = {\n      username,\n      title,\n      role: this.state.role\n    }\n    sessionStorage.setItem(`chime[${title}]`, JSON.stringify(data));\n    this.props.history.push(`${this.baseHref}/meeting?room=${title}`);\n  }\n\n  handleNameChange = e => {\n    this.setState({ username: e.target.value })\n  }\n\n  handleJoinRoom = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.joinRoom();\n  }\n\n  handleClick = (e) => {\n    let node = e.target;\n    let isModal = false;\n    while (node) {\n      if (node && node.classList && node.classList.contains('notice--error')) {\n        isModal = true;\n        break;\n      }\n      node = node.parentNode;\n    }\n    if (!isModal) {\n      this.closeError();\n    }\n  }\n\n  setErrorMsg = errorMsg => {\n    this.setState({ errorMsg, showError: true });\n  }\n\n  closeError = () => {\n    this.setState({ showError: false });\n  }\n\n  render() {\n    const { username } = this.state;\n    const joinRoomDisabled = !username;\n    return (\n      <div className=\"welcome form-grid\" onClick={this.handleClick}>\n\n        <div className=\"welcome__intro\">\n          <div className=\"intro__inner formatted-text\">\n            <h1>Amazon IVS with ChimeSDK</h1>\n            <h3>Create or join rooms, and watch Amazon IVS streams with anyone.</h3>\n          </div>\n        </div>\n\n        <div className=\"welcome__content pd-4\">\n          <div className=\"content__inner\">\n            <h2 className=\"mg-b-2\">Hey there!</h2>\n            <form action=\"\">\n              <fieldset className=\"mg-b-2\">\n                <input type=\"text\" placeholder=\"Your name\" value={username} ref={this.inputRef} onChange={this.handleNameChange} />\n                <button className=\"mg-t-1 btn btn--primary\" disabled={joinRoomDisabled} onClick={this.handleJoinRoom}>Join room</button>\n              </fieldset>\n            </form>\n          </div>\n        </div>\n\n        {this.state.showError && (\n          <Error\n            closeError={this.closeError}\n            errorMsg={this.state.errorMsg}\n          />\n        )}\n      </div>\n    )\n  }\n}\n\nexport default withRouter(Join);\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport * as config from '../../config';\n\n// Styles\n\nclass VideoPlayer extends Component {\n\n  constructor() {\n    super ();\n    this.videoElement = React.createRef();\n    this.state = {\n      maxMetaData: 10,\n      metaData: []\n    }\n  }\n\n  componentDidMount() {\n    const mediaPlayerScript = document.createElement(\"script\");\n    mediaPlayerScript.src = \"https://player.live-video.net/1.2.0/amazon-ivs-player.min.js\";\n    mediaPlayerScript.async = true;\n    mediaPlayerScript.onload = () => this.mediaPlayerScriptLoaded();\n    document.body.appendChild(mediaPlayerScript);\n  }\n\n  mediaPlayerScriptLoaded = () => {\n    // This shows how to include the Amazon IVS Player with a script tag from our CDN\n    // If self hosting, you may not be able to use the create() method since it requires\n    // that file names do not change and are all hosted from the same directory.\n\n    const MediaPlayerPackage = window.IVSPlayer;\n\n    const playerOverlay = document.getElementById(\"overlay\");\n    const btnPlay = document.getElementById(\"play\");\n    const btnMute = document.getElementById(\"mute\");\n\n    // First, check if the browser supports the Amazon IVS player.\n    if (!MediaPlayerPackage.isPlayerSupported) {\n        console.warn(\"The current browser does not support the Amazon IVS player.\");\n        return;\n    }\n\n    const PlayerState = MediaPlayerPackage.PlayerState;\n    const PlayerEventType = MediaPlayerPackage.PlayerEventType;\n\n    // Initialize player\n    const player = MediaPlayerPackage.create();\n    player.attachHTMLVideoElement(document.getElementById(\"video-player\"));\n\n    // Attach event listeners\n    player.addEventListener(PlayerState.PLAYING, function () {\n      if (config.DEBUG) console.log(\"Player State - PLAYING\");\n    });\n    player.addEventListener(PlayerState.ENDED, function () {\n      if (config.DEBUG) console.log(\"Player State - ENDED\");\n    });\n    player.addEventListener(PlayerState.READY, function () {\n      if (config.DEBUG) console.log(\"Player State - READY\");\n    });\n    player.addEventListener(PlayerEventType.ERROR, function (err) {\n      if (config.DEBUG) console.warn(\"Player Event - ERROR:\", err);\n    });\n\n    player.addEventListener(PlayerEventType.TEXT_METADATA_CUE, function (cue) {\n      const metadataText = cue.text;\n      const position = player.getPosition().toFixed(2);\n      if (config.DEBUG) console.log(\n        `Player Event - TEXT_METADATA_CUE: \"${metadataText}\". Observed ${position}s after playback started.`\n      );\n    });\n\n    // Setup stream and play\n    player.setAutoplay(true);\n    player.load(this.props.videoStream);\n\n    // Setvolume\n    player.setVolume(0.1);\n\n    // Show/Hide player controls\n    playerOverlay.addEventListener(\n      \"mouseover\",\n      function (e) {\n        playerOverlay.classList.add(\"overlay--hover\");\n      },\n      false\n    );\n    playerOverlay.addEventListener(\"mouseout\", function (e) {\n      playerOverlay.classList.remove(\"overlay--hover\");\n    });\n\n    // Controls events\n    // Play/Pause\n    btnPlay.addEventListener(\n      \"click\",\n      function (e) {\n        if (btnPlay.classList.contains(\"player-btn--play\")) {\n          // change to pause\n          btnPlay.classList.remove(\"player-btn--play\");\n          btnPlay.classList.add(\"player-btn--pause\");\n          player.pause();\n        } else {\n          // change to play\n          btnPlay.classList.remove(\"player-btn--pause\");\n          btnPlay.classList.add(\"player-btn--play\");\n          player.play();\n        }\n      },\n      false\n    );\n\n    // Mute/Unmute\n    btnMute.addEventListener(\n      \"click\",\n      function (e) {\n        if (btnMute.classList.contains(\"player-btn--mute\")) {\n          btnMute.classList.remove(\"player-btn--mute\");\n          btnMute.classList.add(\"player-btn--unmute\");\n          player.setMuted(1);\n        } else {\n          btnMute.classList.remove(\"player-btn--unmute\");\n          btnMute.classList.add(\"player-btn--mute\");\n          player.setMuted(0);\n        }\n      },\n      false\n    );\n\n  }\n\n  render() {\n    return (\n      <div className=\"player-wrapper pos-relative\">\n        <div className=\"aspect-spacer\"></div>\n        <div className=\"pos-absolute full-width full-height top-0\">\n          <div id=\"overlay\" className=\"overlay\">\n            <div id=\"player-controls\">\n              <div className=\"player-controls__inner\">\n                <button id=\"play\" className=\"mg-x-1 player-btn player-btn--icon player-btn--play\">\n                  <svg\n                    className=\"player-icon player-icon--play\"\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    height=\"36\"\n                    viewBox=\"0 0 24 24\"\n                    width=\"36\"\n                  >\n                    <path\n                      d=\"M8 6.82v10.36c0 .79.87 1.27 1.54.84l8.14-5.18c.62-.39.62-1.29 0-1.69L9.54 5.98C8.87 5.55 8 6.03 8 6.82z\"\n                    />\n                  </svg>\n                  <svg\n                    className=\"player-icon player-icon--pause\"\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    height=\"36\"\n                    viewBox=\"0 0 24 24\"\n                    width=\"36\"\n                  >\n                    <path\n                      d=\"M8 19c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2s-2 .9-2 2v10c0 1.1.9 2 2 2zm6-12v10c0 1.1.9 2 2 2s2-.9 2-2V7c0-1.1-.9-2-2-2s-2 .9-2 2z\"\n                    />\n                  </svg>\n                </button>\n                <button id=\"mute\" className=\"mg-x-1 player-btn player-btn--icon player-btn--unmute\">\n                  <svg\n                    className=\"player-icon player-icon--volume_up\"\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    height=\"24\"\n                    viewBox=\"0 0 24 24\"\n                    width=\"24\"\n                  >\n                    <path\n                      d=\"M3 10v4c0 .55.45 1 1 1h3l3.29 3.29c.63.63 1.71.18 1.71-.71V6.41c0-.89-1.08-1.34-1.71-.71L7 9H4c-.55 0-1 .45-1 1zm13.5 2c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 4.45v.2c0 .38.25.71.6.85C17.18 6.53 19 9.06 19 12s-1.82 5.47-4.4 6.5c-.36.14-.6.47-.6.85v.2c0 .63.63 1.07 1.21.85C18.6 19.11 21 15.84 21 12s-2.4-7.11-5.79-8.4c-.58-.23-1.21.22-1.21.85z\"\n                    />\n                  </svg>\n                  <svg\n                    className=\"player-icon player-icon--volume_off\"\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    height=\"24\"\n                    viewBox=\"0 0 24 24\"\n                    width=\"24\"\n                  >\n                    <path\n                      d=\"M3.63 3.63c-.39.39-.39 1.02 0 1.41L7.29 8.7 7 9H4c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h3l3.29 3.29c.63.63 1.71.18 1.71-.71v-4.17l4.18 4.18c-.49.37-1.02.68-1.6.91-.36.15-.58.53-.58.92 0 .72.73 1.18 1.39.91.8-.33 1.55-.77 2.22-1.31l1.34 1.34c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L5.05 3.63c-.39-.39-1.02-.39-1.42 0zM19 12c0 .82-.15 1.61-.41 2.34l1.53 1.53c.56-1.17.88-2.48.88-3.87 0-3.83-2.4-7.11-5.78-8.4-.59-.23-1.22.23-1.22.86v.19c0 .38.25.71.61.85C17.18 6.54 19 9.06 19 12zm-8.71-6.29l-.17.17L12 7.76V6.41c0-.89-1.08-1.33-1.71-.7zM16.5 12c0-1.77-1.02-3.29-2.5-4.03v1.79l2.48 2.48c.01-.08.02-.16.02-.24z\"\n                    />\n                  </svg>\n                </button>\n              </div>\n            </div>\n          </div>\n          <video id=\"video-player\" className=\"el-player\" ref={this.videoElement} playsInline muted></video>\n        </div>\n      </div>\n    )\n  }\n}\n\nVideoPlayer.propTypes = {\n  setMetadataId: PropTypes.func,\n  videoStream: PropTypes.string,\n};\n\nexport default VideoPlayer;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport {\n  DefaultPromisedWebSocketFactory,\n  DefaultDOMWebSocketFactory,\n  FullJitterBackoff,\n  ReconnectingPromisedWebSocket\n} from 'amazon-chime-sdk-js';\nimport * as config from '../../config';\n\n// Styles\nimport './Chat.css';\n\nclass Chat extends Component {\n  constructor() {\n    super ();\n\n    this.WEB_SOCKET_TIMEOUT_MS = 10000;\n\n    this.state = {\n      message: '',\n      messages: [],\n      connection: null,\n      showPopup: false\n    }\n    this.chatRef = React.createRef();\n    this.messagesEndRef = React.createRef();\n  }\n\n  componentDidMount() {\n    this.initChatConnection();\n  }\n\n  async initChatConnection() {\n    const { Meeting, Attendee } = this.props.joinInfo;\n    const messagingUrl = `${config.CHAT_WEBSOCKET}?MeetingId=${Meeting.MeetingId}&AttendeeId=${Attendee.AttendeeId}&JoinToken=${Attendee.JoinToken}`\n    const connection = new ReconnectingPromisedWebSocket(\n      messagingUrl,\n      [],\n      'arraybuffer',\n      new DefaultPromisedWebSocketFactory(new DefaultDOMWebSocketFactory()),\n      new FullJitterBackoff(1000, 0, 10000)\n    );\n\n    if (config.DEBUG) console.log(connection);\n\n    await connection.open(this.WEB_SOCKET_TIMEOUT_MS);\n\n    connection.addEventListener('message', event => {\n      const messages = this.state.messages;\n      const data = event.data.split('::');\n      const username = data[0];\n      const message = data.slice(1).join('::'); // in case the message contains the separator '::'\n\n      messages.push({\n        timestamp: Date.now(),\n        username,\n        message\n      });\n\n      this.setState({ messages });\n    });\n\n    this.setState({ connection });\n\n    this.chatRef.current.focus();\n  }\n\n  componentDidUpdate() {\n    this.scrollToBottom();\n  }\n\n  scrollToBottom = () => {\n    this.messagesEndRef.current.scrollIntoView({ behavior: 'smooth' })\n  }\n\n  handleChange = e => {\n    this.setState({ message: e.target.value })\n  }\n\n  handleKeyDown = (e) => {\n    if (e.keyCode === 13) { // keyCode 13 is carriage return\n      const { message, connection } = this.state;\n      const { username } = this.props;\n      if (message) {\n        const data = `{\n          \"message\": \"sendmessage\",\n          \"data\": \"${username}::${message.replace(/\\\\/g, '\\\\\\\\').replace(/\"/g, '\\\\\"')}\"\n        }`;\n        connection.send(data);\n\n        this.setState({ message: '' });\n      }\n    }\n  }\n\n  handleRoomClick = (e) => {\n    e.stopPropagation();\n    e.preventDefault();\n    const { title } = this.props;\n    const link = `${window.location.origin}${window.location.pathname.replace('meeting', 'index.html')}?action=join&room=${title}`;\n    if (config.DEBUG) console.log(link);\n    this.copyTextToClipboard(encodeURI(link));\n  }\n\n  setShowPopup = () => {\n    // show popup message\n    this.setState({ showPopup: true });\n\n    // hide popup message after 2 seconds\n    setTimeout(() => {\n      this.setState({ showPopup: false })\n    }, 2000);\n  }\n\n  copyTextToClipboard = text => {\n    if (navigator.clipboard) {\n      navigator.clipboard.writeText(text)\n      .then(() => {\n        this.setShowPopup();\n        if (config.DEBUG) console.log('Room link copied to clipboard');\n      }, (err) => {\n        if (config.DEBUG) console.log('Could not copy text: ', err);\n      });\n    }\n  }\n\n  parseUrls = (userInput) => {\n    var urlRegExp = /(http(s)?:\\/\\/.)?(www\\.)?[-a-zA-Z0-9@:%._~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_.~#?&//=]*)/g;\n    let formattedMessage = userInput.replace(urlRegExp, (match) => {\n      let formattedMatch = match;\n      if (!match.startsWith('http')) {\n        formattedMatch = `http://${match}`;\n      }\n      return `<a href=${formattedMatch} class=\"chat-line__link\" target=\"_blank\" rel=\"noopener noreferrer\">${match}</a>`;\n    });\n    return formattedMessage;\n  }\n\n  renderMessages = () => {\n    const { messages } = this.state;\n    return (\n      messages.map(message => {\n        let formattedMessage = this.parseUrls(message.message);\n        return (\n          <div className=\"chat-line\" key={message.timestamp}>\n            <p><span className=\"username\">{message.username}</span><span dangerouslySetInnerHTML={{__html: formattedMessage}} /></p>\n          </div>\n        )\n      })\n    )\n  }\n\n  render() {\n    const { message, showPopup } = this.state;\n    const popup = showPopup ? 'show' : '';\n    return (\n      <div className=\"chat full-height pos-relative\">\n        <div className=\"chat__room-link full-width\">\n          <button className=\"room-link popup\" onClick={this.handleRoomClick}>\n            <span className=\"room-link__label\">{this.props.title}</span>\n            <svg className=\"room-link__svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M3.25033 9.99999C3.25033 8.57499 4.40866 7.41666 5.83366 7.41666H9.16699V5.83333H5.83366C3.53366 5.83333 1.66699 7.69999 1.66699 9.99999C1.66699 12.3 3.53366 14.1667 5.83366 14.1667H9.16699V12.5833H5.83366C4.40866 12.5833 3.25033 11.425 3.25033 9.99999ZM6.66699 10.8333H13.3337V9.16666H6.66699V10.8333ZM14.167 5.83333H10.8337V7.41666H14.167C15.592 7.41666 16.7503 8.57499 16.7503 9.99999C16.7503 11.425 15.592 12.5833 14.167 12.5833H10.8337V14.1667H14.167C16.467 14.1667 18.3337 12.3 18.3337 9.99999C18.3337 7.69999 16.467 5.83333 14.167 5.83333Z\" fill=\"white\"/></svg>\n            <span className={`popuptext ${popup}`} id=\"myPopup\">Room link copied to clipboard</span>\n          </button>\n        </div>\n        <div className=\"chat__wrapper full-width pos-relative\">\n          <div className=\"messages pd-x-1 pos-absolute\">\n            {this.renderMessages()}\n            <div ref={this.messagesEndRef} />\n          </div>\n        </div>\n        <div className=\"composer chime-web-composer full-width\">\n          <input\n            ref={this.chatRef}\n            type=\"text\"\n            placeholder=\"Say something\"\n            value={message}\n            maxLength={510}\n            onChange={this.handleChange}\n            onKeyDown={this.handleKeyDown}\n          />\n        </div>\n      </div>\n    )\n  }\n}\n\nChat.propTypes = {\n  chime: PropTypes.object,\n  title: PropTypes.string,\n  username: PropTypes.string,\n  joinInfo: PropTypes.object\n};\n\nexport default Chat;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nclass Controls extends Component {\n\n  state = {\n    muted: false,\n    focus: false,\n    videoStatus: 'Disabled'\n  };\n\n  callback = (localMuted) => {\n    this.setState({ muted: localMuted });\n  }\n\n  componentDidMount() {\n    this.props.chime.audioVideo.realtimeSubscribeToMuteAndUnmuteLocalAudio(\n      this.callback\n    );\n  }\n\n  componentWillUnmount() {\n    if (this.props && this.props.chime.audioVideo) {\n      this.props.chime.audioVideo.realtimeUnsubscribeToMuteAndUnmuteLocalAudio(\n        this.callback\n      );\n    }\n  }\n\n  muteButtonOnClick = async () => {\n    if (this.state.muted) {\n      this.props.chime.audioVideo.realtimeUnmuteLocalAudio();\n    } else {\n      this.props.chime.audioVideo.realtimeMuteLocalAudio();\n    }\n    await new Promise(resolve => setTimeout(resolve, 10));\n  }\n\n  videoButtonOnClick = async () => {\n    await new Promise(resolve => setTimeout(resolve, 10));\n    if (this.state.videoStatus === 'Disabled') {\n      this.setState({ videoStatus: 'Loading' });\n      try {\n        if (!this.props.chime.currentVideoInputDevice) {\n          throw new Error('currentVideoInputDevice does not exist');\n        }\n\n        try {\n          await this.props.chime.chooseVideoInputDevice(\n            this.props.chime.currentVideoInputDevice\n          );\n        } catch(err) {\n          const videoInputDevices = await this.props.chime.audioVideo.listVideoInputDevices();\n          await this.props.chime.audioVideo.chooseVideoInputDevice(videoInputDevices[0].deviceId);\n        }\n\n        this.props.chime.audioVideo.startLocalVideoTile();\n\n        this.setState({ videoStatus: 'Enabled' });\n      } catch (error) {\n        // eslint-disable-next-line\n        console.error(error);\n        this.setState({ videoStatus: 'Disabled' });\n      }\n    } else if (this.state.videoStatus === 'Enabled') {\n      this.setState({ videoStatus: 'Loading' });\n      this.props.chime.meetingSession.audioVideo.stopLocalVideoTile();\n      this.setState({ videoStatus: 'Disabled' });\n    }\n  }\n\n  endButtonOnClick = async () => {\n    await this.props.chime.leaveRoom(this.props.role === 'host');\n    sessionStorage.removeItem(this.props.ssName);\n    const whereTo = `${this.props.baseHref}/${this.props.role === 'host' ? '' : 'join?room=' + this.props.title}`;\n    this.props.history.push(whereTo);\n  }\n\n  render() {\n    const mic_controls = this.state.muted ? 'controls__btn--mic_on' : 'controls__btn--mic_off';\n    const cam_controls = this.state.videoStatus === 'Enabled' ? 'controls__btn--cam_off' : 'controls__btn--cam_on';\n    return (\n      <div className=\"controls pos-relative\">\n        {/* <!-- on click, toggle this control between .controls__btn--mic_on and .controls__btn--mic_off --> */}\n        <button className={`controls__btn ${mic_controls} btn rounded btn--mic`} onClick={this.muteButtonOnClick}>\n          <svg className=\"btn__svg btn__svg--mic_on\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M12 14C13.66 14 14.99 12.66 14.99 11L15 5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V11C9 12.66 10.34 14 12 14ZM17.3 11C17.3 14 14.76 16.1 12 16.1C9.24 16.1 6.7 14 6.7 11H5C5 14.41 7.72 17.23 11 17.72V21H13V17.72C16.28 17.24 19 14.42 19 11H17.3Z\" fill=\"white\"/></svg>\n          <svg className=\"btn__svg btn__svg--mic_off\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M19 11H17.3C17.3 11.74 17.14 12.43 16.87 13.05L18.1 14.28C18.66 13.3 19 12.19 19 11ZM14.98 11.17C14.98 11.11 15 11.06 15 11V5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V5.18L14.98 11.17ZM4.27 3L3 4.27L9.01 10.28V11C9.01 12.66 10.34 14 12 14C12.22 14 12.44 13.97 12.65 13.92L14.31 15.58C13.6 15.91 12.81 16.1 12 16.1C9.24 16.1 6.7 14 6.7 11H5C5 14.41 7.72 17.23 11 17.72V21H13V17.72C13.91 17.59 14.77 17.27 15.54 16.82L19.73 21L21 19.73L4.27 3Z\" fill=\"white\"/></svg>\n        </button>\n        {/* <!-- on click, toggle this control between .controls__btn--cam_on and .controls__btn--cam_off --> */}\n        <button className={`controls__btn ${cam_controls} btn rounded btn--cam`} onClick={this.videoButtonOnClick}>\n          <svg className=\"btn__svg btn__svg--cam_on\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M17 10.5V7C17 6.45 16.55 6 16 6H4C3.45 6 3 6.45 3 7V17C3 17.55 3.45 18 4 18H16C16.55 18 17 17.55 17 17V13.5L21 17.5V6.5L17 10.5Z\" fill=\"white\"/></svg>\n          <svg className=\"btn__svg btn__svg--cam_off\"width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M21 6.5L17 10.5V7C17 6.45 16.55 6 16 6H9.82L21 17.18V6.5ZM3.27 2L2 3.27L4.73 6H4C3.45 6 3 6.45 3 7V17C3 17.55 3.45 18 4 18H16C16.21 18 16.39 17.92 16.54 17.82L19.73 21L21 19.73L3.27 2Z\" fill=\"white\"/></svg>\n        </button>\n        <button className=\"controls__btn btn rounded btn--settings\" onClick={this.props.openSettings}>\n          <svg className=\"btn__svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M19.1401 12.936C19.1761 12.636 19.2001 12.324 19.2001 12C19.2001 11.676 19.1761 11.364 19.1281 11.064L21.1561 9.48002C21.3361 9.33602 21.3841 9.07202 21.2761 8.86802L19.3561 5.54402C19.2361 5.32802 18.9841 5.25602 18.7681 5.32802L16.3801 6.28802C15.8761 5.90402 15.3481 5.59202 14.7601 5.35202L14.4001 2.80802C14.3641 2.56802 14.1601 2.40002 13.9201 2.40002H10.0801C9.84011 2.40002 9.64811 2.56802 9.61211 2.80802L9.25211 5.35202C8.66411 5.59202 8.12411 5.91602 7.63211 6.28802L5.24411 5.32802C5.02811 5.24402 4.77611 5.32802 4.65611 5.54402L2.73611 8.86802C2.61611 9.08402 2.66411 9.33602 2.85611 9.48002L4.88411 11.064C4.83611 11.364 4.80011 11.688 4.80011 12C4.80011 12.312 4.82411 12.636 4.87211 12.936L2.84411 14.52C2.66411 14.664 2.61611 14.928 2.72411 15.132L4.64411 18.456C4.76411 18.672 5.01611 18.744 5.23211 18.672L7.62011 17.712C8.12411 18.096 8.65211 18.408 9.24011 18.648L9.60011 21.192C9.64811 21.432 9.84011 21.6 10.0801 21.6H13.9201C14.1601 21.6 14.3641 21.432 14.3881 21.192L14.7481 18.648C15.3361 18.408 15.8761 18.084 16.3681 17.712L18.7561 18.672C18.9721 18.756 19.2241 18.672 19.3441 18.456L21.2641 15.132C21.3841 14.916 21.3361 14.664 21.1441 14.52L19.1401 12.936ZM12.0001 15.6C10.0201 15.6 8.40011 13.98 8.40011 12C8.40011 10.02 10.0201 8.40002 12.0001 8.40002C13.9801 8.40002 15.6001 10.02 15.6001 12C15.6001 13.98 13.9801 15.6 12.0001 15.6Z\"/></svg>\n        </button>\n        <button className=\"controls__btn btn rounded btn--leave btn--destruct\" onClick={this.endButtonOnClick}>\n          <svg className=\"btn__svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M12 9C10.4 9 8.85 9.25 7.4 9.72V12.82C7.4 13.21 7.17 13.56 6.84 13.72C5.86 14.21 4.97 14.84 4.18 15.57C4 15.75 3.75 15.85 3.48 15.85C3.2 15.85 2.95 15.74 2.77 15.56L0.29 13.08C0.11 12.91 0 12.66 0 12.38C0 12.1 0.11 11.85 0.29 11.67C3.34 8.78 7.46 7 12 7C16.54 7 20.66 8.78 23.71 11.67C23.89 11.85 24 12.1 24 12.38C24 12.66 23.89 12.91 23.71 13.09L21.23 15.57C21.05 15.75 20.8 15.86 20.52 15.86C20.25 15.86 20 15.75 19.82 15.58C19.03 14.84 18.13 14.22 17.15 13.73C16.82 13.57 16.59 13.23 16.59 12.83V9.73C15.15 9.25 13.6 9 12 9Z\"/></svg>\n        </button>\n      </div>\n    )\n  }\n}\n\nControls.propTypes = {\n  chime: PropTypes.object,\n  baseHref: PropTypes.string,\n  ssName: PropTypes.string,\n  title: PropTypes.string,\n  openSettings: PropTypes.func,\n  role: PropTypes.string,\n  history: PropTypes.object,\n  myVideoElement: PropTypes.object\n};\n\nexport default Controls;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport * as config from '../../config';\n\nclass Settings extends Component {\n\n  state = {\n    microphone: '',\n    speaker: '',\n    camera: ''\n  }\n\n  devicesUpdatedCallback = (fullDeviceInfo) => {\n    if (config.DEBUG) console.log(fullDeviceInfo);\n  };\n\n  componentDidMount() {\n    document.addEventListener(\"keydown\", this.handleKeyDown);\n\n    this.props.chime.subscribeToDevicesUpdated(this.devicesUpdatedCallback);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener(\"keydown\", this.handleKeyDown);\n\n    this.props.chime.unsubscribeFromDevicesUpdated(this.devicesUpdatedCallback);\n  }\n\n  handleKeyDown = (e) => {\n    if (e.keyCode === 27) { // keyCode 27 is Escape key\n      this.props.closeSettings();\n    }\n  }\n\n  handlePlaybackURLChange = (e) => {\n    this.setState({ playbackURL: e.target.value });\n  }\n\n  handleMicrophoneChange = (e) => {\n    this.setState({ microphone: e.target.value });\n\n    if (this.props.chime.audioInputDevices.length) {\n      let selectedDevice;\n      let o;\n      for (o in this.props.chime.audioInputDevices) {\n        if (this.props.chime.audioInputDevices[o].value === e.target.value) {\n          selectedDevice = this.props.chime.audioInputDevices[o];\n          break;\n        }\n      }\n      this.props.chime.chooseAudioInputDevice(selectedDevice);\n    }\n  }\n\n  handleSpeakerChange = (e) => {\n    this.setState({ speaker: e.target.value });\n\n    if (this.props.chime.audioOutputDevices.length) {\n      let selectedDevice;\n      let o;\n      for (o in this.props.chime.audioOutputDevices) {\n        if (this.props.chime.audioOutputDevices[o].value === e.target.value) {\n          selectedDevice = this.props.chime.audioOutputDevices[o];\n          break;\n        }\n      }\n      this.props.chime.chooseAudioOutputDevice(selectedDevice);\n    }\n  }\n\n  handleCameraChange = async (e) => {\n    this.setState({ camera: e.target.value });\n\n    if (this.props.chime.videoInputDevices.length) {\n      let selectedDevice;\n      let o;\n      for (o in this.props.chime.videoInputDevices) {\n        if (this.props.chime.videoInputDevices[o].value === e.target.value) {\n          selectedDevice = this.props.chime.videoInputDevices[o];\n          break;\n        }\n      }\n      this.props.chime.chooseVideoInputDevice(selectedDevice);\n    }\n  }\n\n  handleSave = (e) => {\n    e.stopPropagation();\n    e.preventDefault();\n    const {microphone, speaker, camera } = this.state;\n    this.props.saveSettings(microphone, speaker, camera);\n  }\n\n  renderDevices = (devices, defaultValue, label) => {\n    if (devices && devices.length) {\n      return (\n        devices.map(device => {\n          return (\n            <option key={device.value} value={device.value}>{`${device.label}`}</option>\n          )\n        })\n      )\n    } else {\n      return (\n      <option value=\"no-permission\">{`Permission not granted to access ${label} devices`}</option>\n      );\n    }\n  }\n\n  render() {\n    const currentMic = this.props.chime.currentAudioInputDevice;\n    const currentSpeaker = this.props.chime.currentAudioOutputDevice;\n    const currentCam = this.props.chime.currentVideoInputDevice;\n    const availableMics = this.props.chime.audioInputDevices;\n    const availableSpeakers = this.props.chime.audioOutputDevices;\n    const availableCams = this.props.chime.videoInputDevices;\n\n    return (\n      <div className=\"modal pos-absolute top-0 bottom-0 \">\n        <div className=\"modal__el\">\n          <h1 className=\"mg-b-2\">Settings</h1>\n          <form>\n            <fieldset>\n              <input className=\"mg-b-2\" name=\"\" id=\"\" type=\"text\" readOnly={true} placeholder=\"Playback URL\" onChange={this.handlePlaybackURLChange} value={this.props.joinInfo.PlaybackURL} disabled />\n              <select\n                name=\"microphone\"\n                className=\"select__field\"\n                onChange={this.handleMicrophoneChange}\n                value={this.state.microphone || currentMic.value}\n                disabled={!availableMics.length}\n              >\n                {this.renderDevices(availableMics, currentMic, 'microphone')}\n              </select>\n              <select\n                name=\"speaker\"\n                className=\"select__field\"\n                onChange={this.handleSpeakerChange}\n                value={this.state.speaker || currentSpeaker.value}\n                disabled={!availableSpeakers.length}\n              >\n                {this.renderDevices(availableSpeakers, currentSpeaker, 'speaker')}\n              </select>\n              <select\n                name=\"camera\"\n                className=\"select__field\"\n                onChange={this.handleCameraChange}\n                value={this.state.camera || currentCam.value}\n                disabled={!availableCams.length}\n              >\n                {this.renderDevices(availableCams, currentCam, 'camera')}\n              </select>\n              <button className=\"btn btn--primary mg-t-2\" onClick={this.handleSave}>Save</button>\n            </fieldset>\n          </form>\n        </div>\n        <div className=\"modal__overlay\"></div>\n      </div>\n    )\n  }\n}\n\nSettings.propTypes = {\n  chime: PropTypes.object,\n  joinInfo: PropTypes.object,\n  saveSettings: PropTypes.func,\n  closeSettings: PropTypes.func,\n  settings: PropTypes.object,\n  checkAudioVideoPermission: PropTypes.func,\n  updateAudioVideoDevices: PropTypes.func,\n};\n\nexport default Settings;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nclass LocalVideo extends Component {\n\n  state = {\n    enabled: false,\n    muted: false,\n    showMeta: true\n  }\n\n  constructor() {\n    super();\n    this.videoElement = React.createRef();\n  }\n\n  rosterCallback = (newRoster) => {\n\n    let attendeeId;\n    for (attendeeId in newRoster) {\n\n      // Exclude others\n      if (attendeeId !== this.props.joinInfo.Attendee.AttendeeId) {\n        continue;\n      }\n\n      this.setState({ muted: newRoster[attendeeId].muted });\n    }\n  };\n\n  componentDidMount() {\n    // Hide meta info after 2 seconds\n    setTimeout(() => {\n      this.setState({\n        showMeta: false\n      });\n    }, 2500);\n\n    this.props.chime.audioVideo.addObserver({\n      videoTileDidUpdate: (tileState) => {\n        if (\n          !tileState.boundAttendeeId ||\n          !tileState.localTile ||\n          !tileState.tileId ||\n          !this.videoElement.current\n        ) {\n          return;\n        }\n        this.props.chime.audioVideo.bindVideoElement(\n          tileState.tileId,\n          this.videoElement.current\n        );\n        this.setState({\n          enabled: tileState.active\n        });\n      }\n    });\n\n    this.props.chime.subscribeToRosterUpdate(this.rosterCallback);\n  }\n\n  componentWillUnmount() {\n    this.props.chime.unsubscribeFromRosterUpdate(this.rosterCallback);\n  }\n\n  handleMouseEnter(e) {\n    this.setState({\n      showMeta: true\n    });\n  }\n\n  handleMouseLeave(e) {\n    this.setState({\n      showMeta: false\n    });\n  }\n\n  render() {\n    // always show metadata when muted\n    const showMeta = this.state.showMeta || this.state.muted || !this.state.enabled;\n\n    const micMuteCls = this.state.muted ? 'controls__btn--mic_on' : 'controls__btn--mic_off';\n    const metaCls = showMeta ? '' : ' cam__meta--hide';\n    return (\n      <div className=\"cam\" onMouseEnter={this.handleMouseEnter.bind(this)} onMouseLeave={this.handleMouseLeave.bind(this)}>\n        <div className=\"cam__preview\">\n          <div className=\"video-container pos-relative\">\n            <video className=\"attendee_cam\" ref={this.videoElement} />\n          </div>\n        </div>\n        <span className={`cam__meta${metaCls}`} id={`${this.props.joinInfo.Attendee.AttendeeId}`}>\n          You\n          <span className={`${micMuteCls} btn--mic`} data-id={this.props.joinInfo.Attendee.AttendeeId}>\n            <svg className=\"attendee mg-l-1 btn__svg btn__svg--sm btn__svg--mic_on\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M12 14C13.66 14 14.99 12.66 14.99 11L15 5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V11C9 12.66 10.34 14 12 14ZM17.3 11C17.3 14 14.76 16.1 12 16.1C9.24 16.1 6.7 14 6.7 11H5C5 14.41 7.72 17.23 11 17.72V21H13V17.72C16.28 17.24 19 14.42 19 11H17.3Z\" fill=\"white\"/></svg>\n            <svg className=\"attendee mg-l-1 btn__svg btn__svg--sm btn__svg--mic_off\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M19 11H17.3C17.3 11.74 17.14 12.43 16.87 13.05L18.1 14.28C18.66 13.3 19 12.19 19 11ZM14.98 11.17C14.98 11.11 15 11.06 15 11V5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V5.18L14.98 11.17ZM4.27 3L3 4.27L9.01 10.28V11C9.01 12.66 10.34 14 12 14C12.22 14 12.44 13.97 12.65 13.92L14.31 15.58C13.6 15.91 12.81 16.1 12 16.1C9.24 16.1 6.7 14 6.7 11H5C5 14.41 7.72 17.23 11 17.72V21H13V17.72C13.91 17.59 14.77 17.27 15.54 16.82L19.73 21L21 19.73L4.27 3Z\" fill=\"white\"/></svg>\n          </span>\n        </span>\n      </div>\n    )\n  }\n}\n\nLocalVideo.propTypes = {\n  chime: PropTypes.object,\n  joinInfo: PropTypes.object\n};\n\nexport default LocalVideo;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nclass RemoteVideo extends Component {\n\n  state = {\n    showMeta: true\n  }\n  \n  componentDidMount() {\n    // Hide meta info after 2 seconds\n    if (!this.props.muted) {\n      setTimeout(() => {\n        this.setState({\n          showMeta: false\n        });\n      }, 2000);\n    }\n  }\n\n  handleMouseEnter(e) {\n    this.setState({\n      showMeta: true\n    });\n  }\n\n  handleMouseLeave(e) {\n    this.setState({\n      showMeta: false\n    });\n  }\n\n  render() {\n    const {\n      attendeeId,\n      videoEnabled,\n      name,\n      muted,\n      videoElement\n    } = this.props;\n    // always show metadata when participant is muted or cam is off\n    const showMeta = this.state.showMeta || muted || !videoEnabled;\n\n    const camClass = attendeeId ? '' : ' hidden';\n    const micMuteCls = muted ? 'controls__btn--mic_on' : 'controls__btn--mic_off';\n    const metaCls =  showMeta ? '' : ' cam__meta--hide';\n    const videoId = `video_${attendeeId}`;\n    return(\n\n        <div className={`cam${camClass}`} key={attendeeId} onMouseEnter={this.handleMouseEnter.bind(this)} onMouseLeave={this.handleMouseLeave.bind(this)}>\n          <div className=\"cam__preview\">\n            <div className=\"video-container pos-relative\">\n              <video ref={videoElement} className=\"attendee_cam remote-attendee\" id={videoId} />\n            </div>\n          </div>\n          <span className={`cam__meta${metaCls}`}>\n            {name}\n            <span className={`${micMuteCls} btn--mic`} data-id={attendeeId}>\n              <svg className=\"attendee mg-l-1 btn__svg btn__svg--sm btn__svg--mic_on\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M12 14C13.66 14 14.99 12.66 14.99 11L15 5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V11C9 12.66 10.34 14 12 14ZM17.3 11C17.3 14 14.76 16.1 12 16.1C9.24 16.1 6.7 14 6.7 11H5C5 14.41 7.72 17.23 11 17.72V21H13V17.72C16.28 17.24 19 14.42 19 11H17.3Z\" fill=\"white\"/></svg>\n              <svg className=\"attendee mg-l-1 btn__svg btn__svg--sm btn__svg--mic_off\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M19 11H17.3C17.3 11.74 17.14 12.43 16.87 13.05L18.1 14.28C18.66 13.3 19 12.19 19 11ZM14.98 11.17C14.98 11.11 15 11.06 15 11V5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V5.18L14.98 11.17ZM4.27 3L3 4.27L9.01 10.28V11C9.01 12.66 10.34 14 12 14C12.22 14 12.44 13.97 12.65 13.92L14.31 15.58C13.6 15.91 12.81 16.1 12 16.1C9.24 16.1 6.7 14 6.7 11H5C5 14.41 7.72 17.23 11 17.72V21H13V17.72C13.91 17.59 14.77 17.27 15.54 16.82L19.73 21L21 19.73L4.27 3Z\" fill=\"white\"/></svg>\n            </span>\n          </span>\n        </div>\n\n    )\n  }\n}\n\nRemoteVideo.propTypes = {\n  chime: PropTypes.object,\n  attendeeId: PropTypes.string,\n  videoEnabled: PropTypes.bool,\n  name: PropTypes.string,\n  muted: PropTypes.bool,\n  videoElement: PropTypes.object\n};\n\nexport default RemoteVideo;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport RemoteVideo from './RemoteVideo';\nimport * as config from '../../config';\n\nconst MAX_REMOTE_VIDEOS = config.CHIME_ROOM_MAX_ATTENDEE;\n\nclass RemoteVideoGroup extends Component {\n\n  state = {\n    rosterChanged: false,\n    roster: []\n  }\n\n  constructor() {\n    super();\n    this.previousRoster = {};\n  }\n\n  findRosterSlot = (attendeeId) => {\n    let index;\n    for (index = 0; index < this.state.roster.length; index++) {\n      if (this.state.roster[index].attendeeId === attendeeId) {\n        return index;\n      }\n    }\n    for (index = 0; index < this.state.roster.length; index++) {\n      if (!this.state.roster[index].attendeeId) {\n        return index;\n      }\n    }\n    return 0;\n  }\n\n  rosterCallback = (newRoster) => {\n\n    if (Object.keys(newRoster).length > 2) {\n      if (config.DEBUG) console.log('More than 2');\n    }\n\n    if (Object.keys(newRoster).length < Object.keys(this.previousRoster).length) {\n      if (config.DEBUG) console.log('Attendee(s) left');\n      const differ = Object.keys(this.previousRoster).filter(k => this.previousRoster[k] !== newRoster[k]);\n      if (config.DEBUG) console.log(differ);\n\n      if (differ.length) {\n        let i;\n        for (i in differ) {\n          const index = this.findRosterSlot(differ[i]);\n          const roster = this.state.roster;\n          roster[index] = {\n            videoElement: roster[index].videoElement\n          }\n          this.setState({ roster });\n        }\n      }\n    }\n\n    this.previousRoster = Object.assign({}, newRoster);\n\n    let attendeeId;\n    for (attendeeId in newRoster) {\n\n      // Exclude self\n      if (attendeeId === this.props.joinInfo.Attendee.AttendeeId) {\n        continue;\n      }\n\n      // exclude empty name\n      if (!newRoster[attendeeId].name) {\n        continue;\n      }\n\n      const index = this.findRosterSlot(attendeeId);\n      const roster = this.state.roster;\n      const attendee = {\n        ...roster[index],\n        attendeeId,\n        ...newRoster[attendeeId]\n      };\n\n      roster[index] = attendee;\n      this.setState({ roster });\n    }\n  };\n\n  videoTileDidUpdateCallback = (tileState) => {\n    if (\n      !tileState.boundAttendeeId ||\n      tileState.localTile ||\n      tileState.isContent ||\n      !tileState.tileId\n    ) {\n      return;\n    }\n\n    let index = this.findRosterSlot(tileState.boundAttendeeId);\n    const roster = this.state.roster;\n    const attendee = {\n      ...roster[index],\n      videoEnabled: tileState.active,\n      attendeeId: tileState.boundAttendeeId,\n      tileId: tileState.tileId\n    };\n    roster[index] = attendee;\n    this.setState({ roster });\n\n    setTimeout(() => {\n      if (config.DEBUG) console.log(roster[index]);\n      const videoElement = document.getElementById(`video_${tileState.boundAttendeeId}`);\n      if (videoElement) {\n        this.props.chime.audioVideo.bindVideoElement(\n          tileState.tileId,\n          videoElement\n        );\n      }\n    }, 1000);\n  };\n\n  videoTileWasRemovedCallback = (tileId) => {\n    let roster = this.state.roster;\n\n    // Find the removed tileId in the roster and mark the video as disabled.\n    // eslint-disable-next-line\n    roster.find((o, i) => {\n      if (o.tileId === tileId) {\n        roster[i].videoEnabled = false;\n        this.setState({ roster });\n        if (config.DEBUG) console.log(`Tile was removed ${tileId}`);\n      }\n    });\n  }\n\n  componentDidMount() {\n    const roster = [];\n    // eslint-disable-next-line\n    Array.from(Array(MAX_REMOTE_VIDEOS).keys()).map((key, index) => {\n      roster[index] = {\n        videoElement: React.createRef()\n      };\n    });\n    this.setState({ roster });\n\n    this.props.chime.subscribeToRosterUpdate(this.rosterCallback);\n\n    this.props.chime.audioVideo.addObserver({\n      videoTileDidUpdate: this.videoTileDidUpdateCallback,\n      videoTileWasRemoved: this.videoTileWasRemovedCallback,\n    });\n  }\n\n  componentWillUnmount() {\n    this.props.chime.unsubscribeFromRosterUpdate(this.rosterCallback);\n  }\n\n  render() {\n    return(\n      <React.Fragment>\n        {this.state.roster.map((attendee, index) => {\n          return (\n            <RemoteVideo\n              chime={this.props.chime}\n              key={index}\n              attendeeId={attendee.attendeeId}\n              videoEnabled={attendee.videoEnabled}\n              name={attendee.name}\n              muted={attendee.muted}\n              videoElement={attendee.videoElement}\n            />\n          );\n        })}\n      </React.Fragment>\n    )\n  }\n}\n\nRemoteVideoGroup.propTypes = {\n  chime: PropTypes.object,\n  joinInfo: PropTypes.object\n};\n\nexport default RemoteVideoGroup;\n","import React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport * as config from '../../config';\n\nimport {\n  MeetingSessionStatusCode\n} from 'amazon-chime-sdk-js';\n\n// Components\nimport VideoPlayer from '../videoPlayer/VideoPlayer';\nimport Chat from '../chat/Chat';\nimport Controls from './Controls';\nimport Settings from './Settings';\nimport LocalVideo from './LocalVideo';\nimport RemoteVideoGroup from './RemoteVideoGroup';\nimport Error from './Error';\n\n// Styles\nimport './ChimeWeb.css';\n\nclass Meeting extends Component {\n\n  state = {\n    meetingStatus: null, // Loading, Success or Failed\n    showSettings: false,\n\n    showError: false,\n    errorMsg: '',\n  }\n\n  constructor() {\n    super();\n\n    this.baseHref = config.BASE_HREF;\n    this.ssName = '';\n\n    this.audioElementRef = React.createRef();\n    this.myVideoElement = React.createRef();\n  }\n\n  componentDidMount() {\n\n    const start = async () => {\n      try {\n\n        const qs = new URLSearchParams(this.props.location.search);\n        const room = qs.get('room');\n        this.ssName = `chime[${room}]`;\n        if (!room || !sessionStorage.getItem(this.ssName)) {\n          this.props.history.push(`${this.baseHref}/`);\n        }\n\n        const ssData = JSON.parse(sessionStorage.getItem(this.ssName));\n        if (config.DEBUG) console.log(ssData);\n\n        this.username = ssData.username;\n        this.title = ssData.title;\n        this.role = ssData.role;\n\n        if (!ssData.joinInfo) {\n          this.joinInfo = await this.props.chime.createRoom(this.role, this.username, this.title, ssData.playbackURL);\n          const data = {\n            ...ssData,\n            joinInfo: this.joinInfo\n          }\n          sessionStorage.setItem(this.ssName, JSON.stringify(data));\n          this.playbackURL = this.joinInfo.PlaybackURL;\n        } else {\n          // Browser refresh\n          this.joinInfo = ssData.joinInfo;\n          this.playbackURL = ssData.joinInfo.PlaybackURL;\n          await this.props.chime.reInitializeMeetingSession(this.joinInfo, this.username);\n        }\n\n        this.setState({ meetingStatus: 'Success' });\n\n        this.props.chime.audioVideo.addObserver({\n          audioVideoDidStop: async (sessionStatus) => {\n            if (sessionStatus.statusCode() === MeetingSessionStatusCode.AudioCallEnded) {\n              const whereTo = `${this.baseHref}/${this.role === 'host' ? '' : 'end'}`;\n              this.props.chime.leaveRoom(this.role === 'host');\n              this.props.history.push(whereTo);\n            }\n          }\n        });\n\n        await this.props.chime.joinRoom(this.audioElementRef.current);\n      } catch (error) {\n        // eslint-disable-next-line\n        console.error(error);\n        this.setState({ meetingStatus: 'Failed' });\n      }\n    };\n    start();\n  }\n\n  /*\n   * Settings\n   */\n\n  openSettings = () => {\n    this.setState({ showSettings: true });\n  }\n\n  closeSettings = () => {\n    this.setState({ showSettings: false });\n  }\n\n  handleClick = (e) => {\n    const { showSettings } = this.state;\n    if (showSettings) {\n      let node = e.target;\n      let isModal = false;\n      while (node) {\n        if (node && node.classList && node.classList.contains('modal__el')) {\n          isModal = true;\n          break;\n        }\n        node = node.parentNode;\n      }\n      if (!isModal) {\n        this.setState({ showSettings: false });\n      }\n    }\n  }\n\n  saveSettings = (playbackURL, currentAudioInputDevice, currentAudioOutputDevice, currentVideoInputDevice) => {\n    this.setState({\n      showSettings: false,\n      currentAudioInputDevice,\n      currentAudioOutputDevice,\n      currentVideoInputDevice\n    });\n  }\n\n  setMetadataId = (metadataId) => {\n    this.setState({ metadataId });\n  }\n\n  setErrorMsg = errorMsg => {\n    this.setState({ errorMsg, showError: true });\n  }\n\n  closeError = () => {\n    this.setState({ showError: false });\n  }\n\n  layout = () => {\n    if(this.state.meetingStatus !== 'Success') {\n      return;\n    }\n\n    return (\n      <div className=\"app-grid\" onClick={this.handleClick}>\n        <div className=\"main-stage\">\n          <div className=\"cams pos-relative\">\n          <LocalVideo\n            chime={this.props.chime}\n            joinInfo={this.joinInfo}\n          />\n          <RemoteVideoGroup\n            chime={this.props.chime}\n            joinInfo={this.joinInfo}\n          />\n          </div>\n          <VideoPlayer\n            setMetadataId={this.setMetadataId}\n            videoStream={this.playbackURL}\n          />\n          <Controls\n            chime={this.props.chime}\n            baseHref={this.baseHref}\n            ssName={this.ssName}\n            title={this.title}\n            openSettings={this.openSettings}\n            role={this.role}\n            history={this.props.history}\n            myVideoElement={this.myVideoElement}\n          />\n        </div>\n        <Chat\n          chime={this.props.chime}\n          title={this.title}\n          username={this.username}\n          joinInfo={this.joinInfo}\n        />\n        {this.state.showSettings && (\n          <Settings\n            chime={this.props.chime}\n            joinInfo={this.joinInfo}\n            saveSettings={this.saveSettings}\n          />\n        )}\n      </div>\n    )\n  }\n\n  render() {\n    return (\n      <React.Fragment>\n\n        <audio ref={this.audioElementRef} style={{ display: 'none' }} />\n\n        {this.layout()}\n\n        {this.state.showError && (\n          <Error\n            closeError={this.closeError}\n            errorMsg={this.state.errorMsg}\n          />\n        )}\n      </React.Fragment>\n    )\n  }\n}\n\nMeeting.propTypes = {\n  chime: PropTypes.object\n};\n\nexport default withRouter(Meeting);\n","import React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport * as config from '../../config';\n\nclass End extends Component {\n\n  constructor() {\n    super();\n    this.baseHref = config.BASE_HREF;\n  }\n\n  render() {\n    return (\n      <div className=\"welcome form-grid\">\n        <div className=\"welcome__intro\">\n          <div className=\"intro__inner formatted-text\">\n            <h1>Amazon IVS with ChimeSDK</h1>\n            <h3>Create or join rooms, and watch Amazon IVS streams with anyone.</h3>\n          </div>\n        </div>\n\n        <div className=\"welcome__content pd-4\">\n          <div className=\"content__inner formatted-text\">\n            <h2 className=\"mg-b-2\">Room closed</h2>\n            <p>The host has ended the meeting and closed the room.</p>\n            <a href={`${this.baseHref}/`} className=\"mg-t-3 btn btn--primary\">Create a new room</a>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default withRouter(End);\n","import React from 'react';\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route\n} from \"react-router-dom\";\nimport * as config from '../config';\n// import './App.css';\n\nimport ChimeSdkWrapper from './chime/ChimeSdkWrapper';\n\nimport Home from './chimeWeb/Welcome';\nimport Join from './chimeWeb/Join';\nimport Meeting from './chimeWeb/Meeting';\nimport End from './chimeWeb/End';\n\nfunction App() {\n  const chime = new ChimeSdkWrapper();\n  const baseHref = config.BASE_HREF;\n\n  return (\n    <div className=\"App full-width full-height\">\n      <Router>\n        <Switch>\n          <Route path={`${baseHref}/end`}>\n            <End />\n          </Route>\n          <Route path={`${baseHref}/meeting`}>\n            <Meeting\n              chime={chime}\n            />\n          </Route>\n          <Route path={`${baseHref}/join`}>\n            <Join\n              chime={chime}\n            />\n          </Route>\n          <Route path={`${baseHref}`}>\n            <Home\n              chime={chime}\n            />\n          </Route>\n        </Switch>\n      </Router>\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}