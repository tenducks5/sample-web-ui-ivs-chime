{"ast":null,"code":"import _regeneratorRuntime from\"/Users/sykang/Documents/Git/amazon-ivs-chime-web-demo/web-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/sykang/Documents/Git/amazon-ivs-chime-web-demo/web-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/sykang/Documents/Git/amazon-ivs-chime-web-demo/web-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/sykang/Documents/Git/amazon-ivs-chime-web-demo/web-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/sykang/Documents/Git/amazon-ivs-chime-web-demo/web-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/sykang/Documents/Git/amazon-ivs-chime-web-demo/web-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{DefaultPromisedWebSocketFactory,DefaultDOMWebSocketFactory,FullJitterBackoff,ReconnectingPromisedWebSocket}from'amazon-chime-sdk-js';import*as config from'../../config';// Styles\nimport'./Chat.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Chat=/*#__PURE__*/function(_Component){_inherits(Chat,_Component);var _super=_createSuper(Chat);function Chat(){var _this;_classCallCheck(this,Chat);_this=_super.call(this);_this.scrollToBottom=function(){_this.messagesEndRef.current.scrollIntoView({behavior:'smooth'});};_this.handleChange=function(e){_this.setState({message:e.target.value});};_this.handleKeyDown=function(e){if(e.keyCode===13){// keyCode 13 is carriage return\nvar _this$state=_this.state,message=_this$state.message,connection=_this$state.connection;var username=_this.props.username;if(message){var data=\"{\\n          \\\"message\\\": \\\"sendmessage\\\",\\n          \\\"data\\\": \\\"\".concat(username,\"::\").concat(message.replace(/\\\\/g,'\\\\\\\\').replace(/\"/g,'\\\\\"'),\"\\\"\\n        }\");connection.send(data);_this.setState({message:''});}}};_this.handleRoomClick=function(e){e.stopPropagation();e.preventDefault();var title=_this.props.title;var link=\"\".concat(window.location.origin).concat(window.location.pathname.replace('meeting','index.html'),\"?action=join&room=\").concat(title);if(config.DEBUG)console.log(link);_this.copyTextToClipboard(encodeURI(link));};_this.setShowPopup=function(){// show popup message\n_this.setState({showPopup:true});// hide popup message after 2 seconds\nsetTimeout(function(){_this.setState({showPopup:false});},2000);};_this.copyTextToClipboard=function(text){if(navigator.clipboard){navigator.clipboard.writeText(text).then(function(){_this.setShowPopup();if(config.DEBUG)console.log('Room link copied to clipboard');},function(err){if(config.DEBUG)console.log('Could not copy text: ',err);});}};_this.parseUrls=function(userInput){var urlRegExp=/(http(s)?:\\/\\/.)?(www\\.)?[-a-zA-Z0-9@:%._~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_.~#?&//=]*)/g;var formattedMessage=userInput.replace(urlRegExp,function(match){var formattedMatch=match;if(!match.startsWith('http')){formattedMatch=\"http://\".concat(match);}return\"<a href=\".concat(formattedMatch,\" class=\\\"chat-line__link\\\" target=\\\"_blank\\\" rel=\\\"noopener noreferrer\\\">\").concat(match,\"</a>\");});return formattedMessage;};_this.renderMessages=function(){var messages=_this.state.messages;return messages.map(function(message){var formattedMessage=_this.parseUrls(message.message);return/*#__PURE__*/_jsx(\"div\",{className:\"chat-line\",children:/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"username\",children:message.username}),/*#__PURE__*/_jsx(\"span\",{dangerouslySetInnerHTML:{__html:formattedMessage}})]})},message.timestamp);});};_this.WEB_SOCKET_TIMEOUT_MS=10000;_this.state={message:'',messages:[],connection:null,showPopup:false};_this.chatRef=/*#__PURE__*/React.createRef();_this.messagesEndRef=/*#__PURE__*/React.createRef();return _this;}_createClass(Chat,[{key:\"componentDidMount\",value:function componentDidMount(){this.initChatConnection();}},{key:\"initChatConnection\",value:function(){var _initChatConnection=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this2=this;var _this$props$joinInfo,Meeting,Attendee,messagingUrl,connection;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this$props$joinInfo=this.props.joinInfo,Meeting=_this$props$joinInfo.Meeting,Attendee=_this$props$joinInfo.Attendee;messagingUrl=\"\".concat(config.CHAT_WEBSOCKET,\"?MeetingId=\").concat(Meeting.MeetingId,\"&AttendeeId=\").concat(Attendee.AttendeeId,\"&JoinToken=\").concat(Attendee.JoinToken);connection=new ReconnectingPromisedWebSocket(messagingUrl,[],'arraybuffer',new DefaultPromisedWebSocketFactory(new DefaultDOMWebSocketFactory()),new FullJitterBackoff(1000,0,10000));if(config.DEBUG)console.log(connection);_context.next=6;return connection.open(this.WEB_SOCKET_TIMEOUT_MS);case 6:connection.addEventListener('message',function(event){var messages=_this2.state.messages;var data=event.data.split('::');var username=data[0];var message=data.slice(1).join('::');// in case the message contains the separator '::'\nmessages.push({timestamp:Date.now(),username:username,message:message});_this2.setState({messages:messages});});this.setState({connection:connection});this.chatRef.current.focus();case 9:case\"end\":return _context.stop();}}},_callee,this);}));function initChatConnection(){return _initChatConnection.apply(this,arguments);}return initChatConnection;}()},{key:\"componentDidUpdate\",value:function componentDidUpdate(){this.scrollToBottom();}},{key:\"render\",value:function render(){var _this$state2=this.state,message=_this$state2.message,showPopup=_this$state2.showPopup;var popup=showPopup?'show':'';return/*#__PURE__*/_jsxs(\"div\",{className:\"chat full-height pos-relative\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"chat__room-link full-width\",children:/*#__PURE__*/_jsxs(\"button\",{className:\"room-link popup\",onClick:this.handleRoomClick,children:[/*#__PURE__*/_jsx(\"span\",{className:\"room-link__label\",children:this.props.title}),/*#__PURE__*/_jsx(\"svg\",{className:\"room-link__svg\",width:\"20\",height:\"20\",viewBox:\"0 0 20 20\",fill:\"none\",xmlns:\"http://www.w3.org/2000/svg\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M3.25033 9.99999C3.25033 8.57499 4.40866 7.41666 5.83366 7.41666H9.16699V5.83333H5.83366C3.53366 5.83333 1.66699 7.69999 1.66699 9.99999C1.66699 12.3 3.53366 14.1667 5.83366 14.1667H9.16699V12.5833H5.83366C4.40866 12.5833 3.25033 11.425 3.25033 9.99999ZM6.66699 10.8333H13.3337V9.16666H6.66699V10.8333ZM14.167 5.83333H10.8337V7.41666H14.167C15.592 7.41666 16.7503 8.57499 16.7503 9.99999C16.7503 11.425 15.592 12.5833 14.167 12.5833H10.8337V14.1667H14.167C16.467 14.1667 18.3337 12.3 18.3337 9.99999C18.3337 7.69999 16.467 5.83333 14.167 5.83333Z\",fill:\"white\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"popuptext \".concat(popup),id:\"myPopup\",children:\"Room link copied to clipboard\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"chat__wrapper full-width pos-relative\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"messages pd-x-1 pos-absolute\",children:[this.renderMessages(),/*#__PURE__*/_jsx(\"div\",{ref:this.messagesEndRef})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"composer chime-web-composer full-width\",children:/*#__PURE__*/_jsx(\"input\",{ref:this.chatRef,type:\"text\",placeholder:\"Say something\",value:message,maxLength:510,onChange:this.handleChange,onKeyDown:this.handleKeyDown})})]});}}]);return Chat;}(Component);export default Chat;","map":{"version":3,"sources":["/Users/sykang/Documents/Git/amazon-ivs-chime-web-demo/web-ui/src/components/chat/Chat.jsx"],"names":["React","Component","DefaultPromisedWebSocketFactory","DefaultDOMWebSocketFactory","FullJitterBackoff","ReconnectingPromisedWebSocket","config","Chat","scrollToBottom","messagesEndRef","current","scrollIntoView","behavior","handleChange","e","setState","message","target","value","handleKeyDown","keyCode","state","connection","username","props","data","replace","send","handleRoomClick","stopPropagation","preventDefault","title","link","window","location","origin","pathname","DEBUG","console","log","copyTextToClipboard","encodeURI","setShowPopup","showPopup","setTimeout","text","navigator","clipboard","writeText","then","err","parseUrls","userInput","urlRegExp","formattedMessage","match","formattedMatch","startsWith","renderMessages","messages","map","__html","timestamp","WEB_SOCKET_TIMEOUT_MS","chatRef","createRef","initChatConnection","joinInfo","Meeting","Attendee","messagingUrl","CHAT_WEBSOCKET","MeetingId","AttendeeId","JoinToken","open","addEventListener","event","split","slice","join","push","Date","now","focus","popup"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport {\n  DefaultPromisedWebSocketFactory,\n  DefaultDOMWebSocketFactory,\n  FullJitterBackoff,\n  ReconnectingPromisedWebSocket\n} from 'amazon-chime-sdk-js';\nimport * as config from '../../config';\n\n// Styles\nimport './Chat.css';\n\nclass Chat extends Component {\n  constructor() {\n    super ();\n\n    this.WEB_SOCKET_TIMEOUT_MS = 10000;\n\n    this.state = {\n      message: '',\n      messages: [],\n      connection: null,\n      showPopup: false\n    }\n    this.chatRef = React.createRef();\n    this.messagesEndRef = React.createRef();\n  }\n\n  componentDidMount() {\n    this.initChatConnection();\n  }\n\n  async initChatConnection() {\n    const { Meeting, Attendee } = this.props.joinInfo;\n    const messagingUrl = `${config.CHAT_WEBSOCKET}?MeetingId=${Meeting.MeetingId}&AttendeeId=${Attendee.AttendeeId}&JoinToken=${Attendee.JoinToken}`\n    const connection = new ReconnectingPromisedWebSocket(\n      messagingUrl,\n      [],\n      'arraybuffer',\n      new DefaultPromisedWebSocketFactory(new DefaultDOMWebSocketFactory()),\n      new FullJitterBackoff(1000, 0, 10000)\n    );\n\n    if (config.DEBUG) console.log(connection);\n\n    await connection.open(this.WEB_SOCKET_TIMEOUT_MS);\n\n    connection.addEventListener('message', event => {\n      const messages = this.state.messages;\n      const data = event.data.split('::');\n      const username = data[0];\n      const message = data.slice(1).join('::'); // in case the message contains the separator '::'\n\n      messages.push({\n        timestamp: Date.now(),\n        username,\n        message\n      });\n\n      this.setState({ messages });\n    });\n\n    this.setState({ connection });\n\n    this.chatRef.current.focus();\n  }\n\n  componentDidUpdate() {\n    this.scrollToBottom();\n  }\n\n  scrollToBottom = () => {\n    this.messagesEndRef.current.scrollIntoView({ behavior: 'smooth' })\n  }\n\n  handleChange = e => {\n    this.setState({ message: e.target.value })\n  }\n\n  handleKeyDown = (e) => {\n    if (e.keyCode === 13) { // keyCode 13 is carriage return\n      const { message, connection } = this.state;\n      const { username } = this.props;\n      if (message) {\n        const data = `{\n          \"message\": \"sendmessage\",\n          \"data\": \"${username}::${message.replace(/\\\\/g, '\\\\\\\\').replace(/\"/g, '\\\\\"')}\"\n        }`;\n        connection.send(data);\n\n        this.setState({ message: '' });\n      }\n    }\n  }\n\n  handleRoomClick = (e) => {\n    e.stopPropagation();\n    e.preventDefault();\n    const { title } = this.props;\n    const link = `${window.location.origin}${window.location.pathname.replace('meeting', 'index.html')}?action=join&room=${title}`;\n    if (config.DEBUG) console.log(link);\n    this.copyTextToClipboard(encodeURI(link));\n  }\n\n  setShowPopup = () => {\n    // show popup message\n    this.setState({ showPopup: true });\n\n    // hide popup message after 2 seconds\n    setTimeout(() => {\n      this.setState({ showPopup: false })\n    }, 2000);\n  }\n\n  copyTextToClipboard = text => {\n    if (navigator.clipboard) {\n      navigator.clipboard.writeText(text)\n      .then(() => {\n        this.setShowPopup();\n        if (config.DEBUG) console.log('Room link copied to clipboard');\n      }, (err) => {\n        if (config.DEBUG) console.log('Could not copy text: ', err);\n      });\n    }\n  }\n\n  parseUrls = (userInput) => {\n    var urlRegExp = /(http(s)?:\\/\\/.)?(www\\.)?[-a-zA-Z0-9@:%._~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_.~#?&//=]*)/g;\n    let formattedMessage = userInput.replace(urlRegExp, (match) => {\n      let formattedMatch = match;\n      if (!match.startsWith('http')) {\n        formattedMatch = `http://${match}`;\n      }\n      return `<a href=${formattedMatch} class=\"chat-line__link\" target=\"_blank\" rel=\"noopener noreferrer\">${match}</a>`;\n    });\n    return formattedMessage;\n  }\n\n  renderMessages = () => {\n    const { messages } = this.state;\n    return (\n      messages.map(message => {\n        let formattedMessage = this.parseUrls(message.message);\n        return (\n          <div className=\"chat-line\" key={message.timestamp}>\n            <p><span className=\"username\">{message.username}</span><span dangerouslySetInnerHTML={{__html: formattedMessage}} /></p>\n          </div>\n        )\n      })\n    )\n  }\n\n  render() {\n    const { message, showPopup } = this.state;\n    const popup = showPopup ? 'show' : '';\n    return (\n      <div className=\"chat full-height pos-relative\">\n        <div className=\"chat__room-link full-width\">\n          <button className=\"room-link popup\" onClick={this.handleRoomClick}>\n            <span className=\"room-link__label\">{this.props.title}</span>\n            <svg className=\"room-link__svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M3.25033 9.99999C3.25033 8.57499 4.40866 7.41666 5.83366 7.41666H9.16699V5.83333H5.83366C3.53366 5.83333 1.66699 7.69999 1.66699 9.99999C1.66699 12.3 3.53366 14.1667 5.83366 14.1667H9.16699V12.5833H5.83366C4.40866 12.5833 3.25033 11.425 3.25033 9.99999ZM6.66699 10.8333H13.3337V9.16666H6.66699V10.8333ZM14.167 5.83333H10.8337V7.41666H14.167C15.592 7.41666 16.7503 8.57499 16.7503 9.99999C16.7503 11.425 15.592 12.5833 14.167 12.5833H10.8337V14.1667H14.167C16.467 14.1667 18.3337 12.3 18.3337 9.99999C18.3337 7.69999 16.467 5.83333 14.167 5.83333Z\" fill=\"white\"/></svg>\n            <span className={`popuptext ${popup}`} id=\"myPopup\">Room link copied to clipboard</span>\n          </button>\n        </div>\n        <div className=\"chat__wrapper full-width pos-relative\">\n          <div className=\"messages pd-x-1 pos-absolute\">\n            {this.renderMessages()}\n            <div ref={this.messagesEndRef} />\n          </div>\n        </div>\n        <div className=\"composer chime-web-composer full-width\">\n          <input\n            ref={this.chatRef}\n            type=\"text\"\n            placeholder=\"Say something\"\n            value={message}\n            maxLength={510}\n            onChange={this.handleChange}\n            onKeyDown={this.handleKeyDown}\n          />\n        </div>\n      </div>\n    )\n  }\n}\n\nChat.propTypes = {\n  chime: PropTypes.object,\n  title: PropTypes.string,\n  username: PropTypes.string,\n  joinInfo: PropTypes.object\n};\n\nexport default Chat;\n"]},"metadata":{},"sourceType":"module"}