{"ast":null,"code":"\"use strict\"; // Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar DefaultJPEGDecoderController_1 = require(\"../../jpegdecoder/controller/DefaultJPEGDecoderController\");\n\nvar ScreenViewingMessageDispatcher_1 = require(\"../clientobserver/ScreenViewingMessageDispatcher\");\n\nvar DefaultScreenViewingDeltaRenderer_1 = require(\"../deltarenderer/DefaultScreenViewingDeltaRenderer\");\n\nvar DefaultScreenViewingDeltaSource_1 = require(\"../deltasource/DefaultScreenViewingDeltaSource\");\n\nvar DefaultScreenViewingMessageHandler_1 = require(\"../messagehandler/DefaultScreenViewingMessageHandler\");\n\nvar DefaultScreenViewingSession_1 = require(\"../session/DefaultScreenViewingSession\");\n\nvar DefaultSignalingSession_1 = require(\"../signalingsession/DefaultSignalingSession\");\n\nvar DefaultScreenViewingViewer_1 = require(\"../viewer/DefaultScreenViewingViewer\");\n\nvar DefaultScreenViewingComponentContext =\n/** @class */\nfunction () {\n  function DefaultScreenViewingComponentContext(resizeObserverAdapterFactory, dragObserverFactory, reconnectingWSFactory, screenSignalingSessionFactory, logger, providers, window) {\n    var session = this.createSession(reconnectingWSFactory, logger, providers);\n    var jpegDecoderController = this.createJPEGDecoderController(logger, providers);\n    var deltaRenderer = this.createDeltaRenderer(jpegDecoderController, logger, window, resizeObserverAdapterFactory, dragObserverFactory, providers);\n    var deltaSource = this.createDeltaSource(deltaRenderer, logger, providers);\n    var viewer = this.createViewer(deltaRenderer, logger, providers);\n    var messageHandler = this.createMessageHandler(session, deltaRenderer, deltaSource, viewer, logger, providers);\n    var messageDispatcher = this.createMessageDispatcher(messageHandler, providers);\n    var signalingSession = this.createSignalingSession(screenSignalingSessionFactory, providers);\n    signalingSession.registerObserver({\n      streamDidStart: function streamDidStart(_screenMessageDetail) {\n        deltaRenderer.revealViewport();\n      },\n      streamDidStop: function streamDidStop(_screenMessageDetail) {\n        deltaRenderer.hideViewport();\n      }\n    });\n    this.viewingSession = session.withObserver(messageDispatcher);\n    this.deltaRenderer = deltaRenderer;\n    this.deltaSource = deltaSource;\n    this.jpegDecoderController = jpegDecoderController;\n    this.messageDispatcher = messageDispatcher;\n    this.messageHandler = messageHandler;\n    this.signalingSession = signalingSession;\n    this.viewer = viewer;\n  }\n\n  DefaultScreenViewingComponentContext.prototype.createSession = function (reconnectingWSFactory, logger, providers) {\n    var screenViewingSession = new DefaultScreenViewingSession_1.default(reconnectingWSFactory, logger);\n    return providers && providers.sessionProvider && providers.sessionProvider(screenViewingSession) || screenViewingSession;\n  };\n\n  DefaultScreenViewingComponentContext.prototype.createDeltaRenderer = function (jpegDecoderController, logger, window, resizeObserverAdapterFactory, dragObserverFactory, providers) {\n    var deltaRenderer = new DefaultScreenViewingDeltaRenderer_1.default(jpegDecoderController, logger, window, resizeObserverAdapterFactory, dragObserverFactory);\n    return providers && providers.deltaRendererProvider && providers.deltaRendererProvider(deltaRenderer) || deltaRenderer;\n  };\n\n  DefaultScreenViewingComponentContext.prototype.createDeltaSource = function (deltaRenderer, logger, providers) {\n    var deltaSource = new DefaultScreenViewingDeltaSource_1.default(deltaRenderer, logger);\n    return providers && providers.deltaSourceProvider && providers.deltaSourceProvider(deltaSource) || deltaSource;\n  };\n\n  DefaultScreenViewingComponentContext.prototype.createJPEGDecoderController = function (logger, providers) {\n    var jpegDecoderController = new DefaultJPEGDecoderController_1.default(logger, 65536);\n    return providers && providers.jpegDecoderControllerProvider && providers.jpegDecoderControllerProvider(jpegDecoderController) || jpegDecoderController;\n  };\n\n  DefaultScreenViewingComponentContext.prototype.createMessageDispatcher = function (messageHandler, providers) {\n    var messageDispatcher = new ScreenViewingMessageDispatcher_1.default(messageHandler);\n    return providers && providers.messageDispatcherProvider && providers.messageDispatcherProvider(messageDispatcher) || messageDispatcher;\n  };\n\n  DefaultScreenViewingComponentContext.prototype.createMessageHandler = function (session, deltaRenderer, deltaSource, viewer, logger, providers) {\n    var messageHandler = new DefaultScreenViewingMessageHandler_1.default(session, deltaRenderer, deltaSource, viewer, logger);\n    return providers && providers.messageHandlerProvider && providers.messageHandlerProvider(messageHandler) || messageHandler;\n  };\n\n  DefaultScreenViewingComponentContext.prototype.createViewer = function (deltaRenderer, logger, providers) {\n    var viewer = new DefaultScreenViewingViewer_1.default(deltaRenderer, logger);\n    return providers && providers.viewerProvider && providers.viewerProvider(viewer) || viewer;\n  };\n\n  DefaultScreenViewingComponentContext.prototype.createSignalingSession = function (screenSignalingSessionFactory, providers) {\n    var signalingSession = new DefaultSignalingSession_1.default(screenSignalingSessionFactory);\n    return providers && providers.signalingSession && providers.signalingSession(signalingSession) || signalingSession;\n  };\n\n  return DefaultScreenViewingComponentContext;\n}();\n\nexports.default = DefaultScreenViewingComponentContext;","map":{"version":3,"sources":["../../../src/screenviewing/context/DefaultScreenViewingComponentContext.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\n// Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar DefaultJPEGDecoderController_1 = require(\"../../jpegdecoder/controller/DefaultJPEGDecoderController\");\nvar ScreenViewingMessageDispatcher_1 = require(\"../clientobserver/ScreenViewingMessageDispatcher\");\nvar DefaultScreenViewingDeltaRenderer_1 = require(\"../deltarenderer/DefaultScreenViewingDeltaRenderer\");\nvar DefaultScreenViewingDeltaSource_1 = require(\"../deltasource/DefaultScreenViewingDeltaSource\");\nvar DefaultScreenViewingMessageHandler_1 = require(\"../messagehandler/DefaultScreenViewingMessageHandler\");\nvar DefaultScreenViewingSession_1 = require(\"../session/DefaultScreenViewingSession\");\nvar DefaultSignalingSession_1 = require(\"../signalingsession/DefaultSignalingSession\");\nvar DefaultScreenViewingViewer_1 = require(\"../viewer/DefaultScreenViewingViewer\");\nvar DefaultScreenViewingComponentContext = /** @class */ (function () {\n    function DefaultScreenViewingComponentContext(resizeObserverAdapterFactory, dragObserverFactory, reconnectingWSFactory, screenSignalingSessionFactory, logger, providers, window) {\n        var session = this.createSession(reconnectingWSFactory, logger, providers);\n        var jpegDecoderController = this.createJPEGDecoderController(logger, providers);\n        var deltaRenderer = this.createDeltaRenderer(jpegDecoderController, logger, window, resizeObserverAdapterFactory, dragObserverFactory, providers);\n        var deltaSource = this.createDeltaSource(deltaRenderer, logger, providers);\n        var viewer = this.createViewer(deltaRenderer, logger, providers);\n        var messageHandler = this.createMessageHandler(session, deltaRenderer, deltaSource, viewer, logger, providers);\n        var messageDispatcher = this.createMessageDispatcher(messageHandler, providers);\n        var signalingSession = this.createSignalingSession(screenSignalingSessionFactory, providers);\n        signalingSession.registerObserver({\n            streamDidStart: function (_screenMessageDetail) {\n                deltaRenderer.revealViewport();\n            },\n            streamDidStop: function (_screenMessageDetail) {\n                deltaRenderer.hideViewport();\n            },\n        });\n        this.viewingSession = session.withObserver(messageDispatcher);\n        this.deltaRenderer = deltaRenderer;\n        this.deltaSource = deltaSource;\n        this.jpegDecoderController = jpegDecoderController;\n        this.messageDispatcher = messageDispatcher;\n        this.messageHandler = messageHandler;\n        this.signalingSession = signalingSession;\n        this.viewer = viewer;\n    }\n    DefaultScreenViewingComponentContext.prototype.createSession = function (reconnectingWSFactory, logger, providers) {\n        var screenViewingSession = new DefaultScreenViewingSession_1.default(reconnectingWSFactory, logger);\n        return ((providers && providers.sessionProvider && providers.sessionProvider(screenViewingSession)) ||\n            screenViewingSession);\n    };\n    DefaultScreenViewingComponentContext.prototype.createDeltaRenderer = function (jpegDecoderController, logger, window, resizeObserverAdapterFactory, dragObserverFactory, providers) {\n        var deltaRenderer = new DefaultScreenViewingDeltaRenderer_1.default(jpegDecoderController, logger, window, resizeObserverAdapterFactory, dragObserverFactory);\n        return ((providers &&\n            providers.deltaRendererProvider &&\n            providers.deltaRendererProvider(deltaRenderer)) ||\n            deltaRenderer);\n    };\n    DefaultScreenViewingComponentContext.prototype.createDeltaSource = function (deltaRenderer, logger, providers) {\n        var deltaSource = new DefaultScreenViewingDeltaSource_1.default(deltaRenderer, logger);\n        return ((providers && providers.deltaSourceProvider && providers.deltaSourceProvider(deltaSource)) ||\n            deltaSource);\n    };\n    DefaultScreenViewingComponentContext.prototype.createJPEGDecoderController = function (logger, providers) {\n        var jpegDecoderController = new DefaultJPEGDecoderController_1.default(logger, 65536);\n        return ((providers &&\n            providers.jpegDecoderControllerProvider &&\n            providers.jpegDecoderControllerProvider(jpegDecoderController)) ||\n            jpegDecoderController);\n    };\n    DefaultScreenViewingComponentContext.prototype.createMessageDispatcher = function (messageHandler, providers) {\n        var messageDispatcher = new ScreenViewingMessageDispatcher_1.default(messageHandler);\n        return ((providers &&\n            providers.messageDispatcherProvider &&\n            providers.messageDispatcherProvider(messageDispatcher)) ||\n            messageDispatcher);\n    };\n    DefaultScreenViewingComponentContext.prototype.createMessageHandler = function (session, deltaRenderer, deltaSource, viewer, logger, providers) {\n        var messageHandler = new DefaultScreenViewingMessageHandler_1.default(session, deltaRenderer, deltaSource, viewer, logger);\n        return ((providers &&\n            providers.messageHandlerProvider &&\n            providers.messageHandlerProvider(messageHandler)) ||\n            messageHandler);\n    };\n    DefaultScreenViewingComponentContext.prototype.createViewer = function (deltaRenderer, logger, providers) {\n        var viewer = new DefaultScreenViewingViewer_1.default(deltaRenderer, logger);\n        return (providers && providers.viewerProvider && providers.viewerProvider(viewer)) || viewer;\n    };\n    DefaultScreenViewingComponentContext.prototype.createSignalingSession = function (screenSignalingSessionFactory, providers) {\n        var signalingSession = new DefaultSignalingSession_1.default(screenSignalingSessionFactory);\n        return ((providers && providers.signalingSession && providers.signalingSession(signalingSession)) ||\n            signalingSession);\n    };\n    return DefaultScreenViewingComponentContext;\n}());\nexports.default = DefaultScreenViewingComponentContext;\n//# sourceMappingURL=DefaultScreenViewingComponentContext.js.map"]},"metadata":{},"sourceType":"script"}