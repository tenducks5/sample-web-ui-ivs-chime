{"ast":null,"code":"\"use strict\"; // Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar ConnectionHealthData =\n/** @class */\nfunction () {\n  function ConnectionHealthData() {\n    this.connectionStartTimestampMs = 0;\n    this.consecutiveStatsWithNoPackets = 0;\n    this.lastPacketLossInboundTimestampMs = 0;\n    this.lastGoodSignalTimestampMs = 0;\n    this.lastWeakSignalTimestampMs = 0;\n    this.lastNoSignalTimestampMs = 0;\n    this.consecutiveMissedPongs = 0;\n    this.packetsReceivedInLastMinute = [];\n    this.fractionPacketsLostInboundInLastMinute = [];\n    this.audioSpeakerDelayMs = 0;\n    this.connectionStartTimestampMs = Date.now();\n    this.lastGoodSignalTimestampMs = Date.now();\n  }\n\n  ConnectionHealthData.isTimestampRecent = function (timestampMs, recentDurationMs) {\n    return Date.now() < timestampMs + recentDurationMs;\n  };\n\n  ConnectionHealthData.prototype.setConnectionStartTime = function () {\n    this.connectionStartTimestampMs = Date.now();\n    this.lastGoodSignalTimestampMs = Date.now();\n  };\n\n  ConnectionHealthData.prototype.reset = function () {\n    this.connectionStartTimestampMs = 0;\n    this.consecutiveStatsWithNoPackets = 0;\n    this.lastPacketLossInboundTimestampMs = 0;\n    this.lastGoodSignalTimestampMs = 0;\n    this.lastWeakSignalTimestampMs = 0;\n    this.lastNoSignalTimestampMs = 0;\n    this.consecutiveMissedPongs = 0;\n    this.packetsReceivedInLastMinute = [];\n    this.fractionPacketsLostInboundInLastMinute = [];\n    this.audioSpeakerDelayMs = 0;\n    this.connectionStartTimestampMs = Date.now();\n    this.lastGoodSignalTimestampMs = Date.now();\n  };\n\n  ConnectionHealthData.prototype.isConnectionStartRecent = function (recentDurationMs) {\n    return ConnectionHealthData.isTimestampRecent(this.connectionStartTimestampMs, recentDurationMs);\n  };\n\n  ConnectionHealthData.prototype.isLastPacketLossRecent = function (recentDurationMs) {\n    return ConnectionHealthData.isTimestampRecent(this.lastPacketLossInboundTimestampMs, recentDurationMs);\n  };\n\n  ConnectionHealthData.prototype.isGoodSignalRecent = function (recentDurationMs) {\n    return ConnectionHealthData.isTimestampRecent(this.lastGoodSignalTimestampMs, recentDurationMs);\n  };\n\n  ConnectionHealthData.prototype.isWeakSignalRecent = function (recentDurationMs) {\n    return ConnectionHealthData.isTimestampRecent(this.lastWeakSignalTimestampMs, recentDurationMs);\n  };\n\n  ConnectionHealthData.prototype.isNoSignalRecent = function (recentDurationMs) {\n    return ConnectionHealthData.isTimestampRecent(this.lastNoSignalTimestampMs, recentDurationMs);\n  };\n\n  ConnectionHealthData.prototype.clone = function () {\n    var cloned = new ConnectionHealthData();\n    cloned.connectionStartTimestampMs = this.connectionStartTimestampMs;\n    cloned.consecutiveStatsWithNoPackets = this.consecutiveStatsWithNoPackets;\n    cloned.lastPacketLossInboundTimestampMs = this.lastPacketLossInboundTimestampMs;\n    cloned.lastGoodSignalTimestampMs = this.lastGoodSignalTimestampMs;\n    cloned.lastWeakSignalTimestampMs = this.lastWeakSignalTimestampMs;\n    cloned.lastNoSignalTimestampMs = this.lastNoSignalTimestampMs;\n    cloned.consecutiveMissedPongs = this.consecutiveMissedPongs;\n    cloned.packetsReceivedInLastMinute = this.packetsReceivedInLastMinute.slice(0);\n    cloned.fractionPacketsLostInboundInLastMinute = this.fractionPacketsLostInboundInLastMinute.slice(0);\n    cloned.audioSpeakerDelayMs = this.audioSpeakerDelayMs;\n    return cloned;\n  };\n\n  ConnectionHealthData.prototype.setConsecutiveMissedPongs = function (pongs) {\n    this.consecutiveMissedPongs = pongs;\n  };\n\n  ConnectionHealthData.prototype.setConsecutiveStatsWithNoPackets = function (stats) {\n    this.consecutiveStatsWithNoPackets = stats;\n  };\n\n  ConnectionHealthData.prototype.setLastPacketLossInboundTimestampMs = function (timeStamp) {\n    this.lastPacketLossInboundTimestampMs = timeStamp;\n  };\n\n  ConnectionHealthData.prototype.setLastNoSignalTimestampMs = function (timeStamp) {\n    this.lastNoSignalTimestampMs = timeStamp;\n  };\n\n  ConnectionHealthData.prototype.setLastWeakSignalTimestampMs = function (timeStamp) {\n    this.lastWeakSignalTimestampMs = timeStamp;\n  };\n\n  ConnectionHealthData.prototype.setLastGoodSignalTimestampMs = function (timeStamp) {\n    this.lastGoodSignalTimestampMs = timeStamp;\n  };\n\n  ConnectionHealthData.prototype.setAudioSpeakerDelayMs = function (delayMs) {\n    this.audioSpeakerDelayMs = delayMs;\n  };\n\n  return ConnectionHealthData;\n}();\n\nexports.default = ConnectionHealthData;","map":{"version":3,"sources":["../../src/connectionhealthpolicy/ConnectionHealthData.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\n// Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ConnectionHealthData = /** @class */ (function () {\n    function ConnectionHealthData() {\n        this.connectionStartTimestampMs = 0;\n        this.consecutiveStatsWithNoPackets = 0;\n        this.lastPacketLossInboundTimestampMs = 0;\n        this.lastGoodSignalTimestampMs = 0;\n        this.lastWeakSignalTimestampMs = 0;\n        this.lastNoSignalTimestampMs = 0;\n        this.consecutiveMissedPongs = 0;\n        this.packetsReceivedInLastMinute = [];\n        this.fractionPacketsLostInboundInLastMinute = [];\n        this.audioSpeakerDelayMs = 0;\n        this.connectionStartTimestampMs = Date.now();\n        this.lastGoodSignalTimestampMs = Date.now();\n    }\n    ConnectionHealthData.isTimestampRecent = function (timestampMs, recentDurationMs) {\n        return Date.now() < timestampMs + recentDurationMs;\n    };\n    ConnectionHealthData.prototype.setConnectionStartTime = function () {\n        this.connectionStartTimestampMs = Date.now();\n        this.lastGoodSignalTimestampMs = Date.now();\n    };\n    ConnectionHealthData.prototype.reset = function () {\n        this.connectionStartTimestampMs = 0;\n        this.consecutiveStatsWithNoPackets = 0;\n        this.lastPacketLossInboundTimestampMs = 0;\n        this.lastGoodSignalTimestampMs = 0;\n        this.lastWeakSignalTimestampMs = 0;\n        this.lastNoSignalTimestampMs = 0;\n        this.consecutiveMissedPongs = 0;\n        this.packetsReceivedInLastMinute = [];\n        this.fractionPacketsLostInboundInLastMinute = [];\n        this.audioSpeakerDelayMs = 0;\n        this.connectionStartTimestampMs = Date.now();\n        this.lastGoodSignalTimestampMs = Date.now();\n    };\n    ConnectionHealthData.prototype.isConnectionStartRecent = function (recentDurationMs) {\n        return ConnectionHealthData.isTimestampRecent(this.connectionStartTimestampMs, recentDurationMs);\n    };\n    ConnectionHealthData.prototype.isLastPacketLossRecent = function (recentDurationMs) {\n        return ConnectionHealthData.isTimestampRecent(this.lastPacketLossInboundTimestampMs, recentDurationMs);\n    };\n    ConnectionHealthData.prototype.isGoodSignalRecent = function (recentDurationMs) {\n        return ConnectionHealthData.isTimestampRecent(this.lastGoodSignalTimestampMs, recentDurationMs);\n    };\n    ConnectionHealthData.prototype.isWeakSignalRecent = function (recentDurationMs) {\n        return ConnectionHealthData.isTimestampRecent(this.lastWeakSignalTimestampMs, recentDurationMs);\n    };\n    ConnectionHealthData.prototype.isNoSignalRecent = function (recentDurationMs) {\n        return ConnectionHealthData.isTimestampRecent(this.lastNoSignalTimestampMs, recentDurationMs);\n    };\n    ConnectionHealthData.prototype.clone = function () {\n        var cloned = new ConnectionHealthData();\n        cloned.connectionStartTimestampMs = this.connectionStartTimestampMs;\n        cloned.consecutiveStatsWithNoPackets = this.consecutiveStatsWithNoPackets;\n        cloned.lastPacketLossInboundTimestampMs = this.lastPacketLossInboundTimestampMs;\n        cloned.lastGoodSignalTimestampMs = this.lastGoodSignalTimestampMs;\n        cloned.lastWeakSignalTimestampMs = this.lastWeakSignalTimestampMs;\n        cloned.lastNoSignalTimestampMs = this.lastNoSignalTimestampMs;\n        cloned.consecutiveMissedPongs = this.consecutiveMissedPongs;\n        cloned.packetsReceivedInLastMinute = this.packetsReceivedInLastMinute.slice(0);\n        cloned.fractionPacketsLostInboundInLastMinute = this.fractionPacketsLostInboundInLastMinute.slice(0);\n        cloned.audioSpeakerDelayMs = this.audioSpeakerDelayMs;\n        return cloned;\n    };\n    ConnectionHealthData.prototype.setConsecutiveMissedPongs = function (pongs) {\n        this.consecutiveMissedPongs = pongs;\n    };\n    ConnectionHealthData.prototype.setConsecutiveStatsWithNoPackets = function (stats) {\n        this.consecutiveStatsWithNoPackets = stats;\n    };\n    ConnectionHealthData.prototype.setLastPacketLossInboundTimestampMs = function (timeStamp) {\n        this.lastPacketLossInboundTimestampMs = timeStamp;\n    };\n    ConnectionHealthData.prototype.setLastNoSignalTimestampMs = function (timeStamp) {\n        this.lastNoSignalTimestampMs = timeStamp;\n    };\n    ConnectionHealthData.prototype.setLastWeakSignalTimestampMs = function (timeStamp) {\n        this.lastWeakSignalTimestampMs = timeStamp;\n    };\n    ConnectionHealthData.prototype.setLastGoodSignalTimestampMs = function (timeStamp) {\n        this.lastGoodSignalTimestampMs = timeStamp;\n    };\n    ConnectionHealthData.prototype.setAudioSpeakerDelayMs = function (delayMs) {\n        this.audioSpeakerDelayMs = delayMs;\n    };\n    return ConnectionHealthData;\n}());\nexports.default = ConnectionHealthData;\n//# sourceMappingURL=ConnectionHealthData.js.map"]},"metadata":{},"sourceType":"script"}